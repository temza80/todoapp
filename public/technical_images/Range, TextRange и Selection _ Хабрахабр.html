<!DOCTYPE html>
<html lang="ru" class="no-js">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta content='width=1024' name='viewport'>
<title>Range, TextRange и Selection / Хабрахабр</title>

  <meta name="description" content="Многим JavaScript-разработчикам приходилось сталкиваться с объектами, перечисленными в заголовке, например, при решении следующих задач:
 — создание визуальных редакторов (wysiwyg),
 — поиск в..." />

  <meta name="keywords" content="JavaScript, Range, TextRange, Selection" />
  <meta property="fb:app_id"      content="444736788986613" /> 
<meta property="og:type"        content="article" /> 
<meta property="og:url"         content="https://habrahabr.ru/post/55922/" /> 
<meta property="og:title"       content="Range, TextRange и Selection" />
	<meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/d86/306/e47/d86306e474a89377a537d48d365846da.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/d86/306/e47/d86306e474a89377a537d48d365846da.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/576/500/807/57650080760b39c44fb782b7193c9005.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/576/500/807/57650080760b39c44fb782b7193c9005.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/b2d/f7a/89d/b2df7a89dcf08d3344528b3282d5ff71.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/b2d/f7a/89d/b2df7a89dcf08d3344528b3282d5ff71.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/32b/3fa/755/32b3fa7553da67019db6d386f590713e.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/32b/3fa/755/32b3fa7553da67019db6d386f590713e.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/c14/a5b/8b5/c14a5b8b526c93bd88904c1cfcaa646e.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/c14/a5b/8b5/c14a5b8b526c93bd88904c1cfcaa646e.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/05e/bc5/3dc/05ebc53dc9a35802d729f0d81ed5a5d6.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/05e/bc5/3dc/05ebc53dc9a35802d729f0d81ed5a5d6.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/5be/bbe/f20/5bebbef2012d4adf996f7e05ba36f6e1.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/5be/bbe/f20/5bebbef2012d4adf996f7e05ba36f6e1.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/58e/0d1/ed1/58e0d1ed15240e9c2acf53d14c3214c2.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/58e/0d1/ed1/58e0d1ed15240e9c2acf53d14c3214c2.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/d86/306/e47/d86306e474a89377a537d48d365846da.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/d86/306/e47/d86306e474a89377a537d48d365846da.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/576/500/807/57650080760b39c44fb782b7193c9005.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/576/500/807/57650080760b39c44fb782b7193c9005.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/b2d/f7a/89d/b2df7a89dcf08d3344528b3282d5ff71.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/b2d/f7a/89d/b2df7a89dcf08d3344528b3282d5ff71.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/32b/3fa/755/32b3fa7553da67019db6d386f590713e.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/32b/3fa/755/32b3fa7553da67019db6d386f590713e.gif" /><meta property="og:image"       content="https://habrastorage.org/getpro/habr/post_images/58e/0d1/ed1/58e0d1ed15240e9c2acf53d14c3214c2.gif" />
	<link rel="image_src" href="https://habrastorage.org/getpro/habr/post_images/58e/0d1/ed1/58e0d1ed15240e9c2acf53d14c3214c2.gif" />
	
<meta property="og:description" content="Многим JavaScript-разработчикам приходилось сталкиваться с объектами, перечисленными в заголовке, например, при решении следующих задач:  &mdash; создание визуальных..." />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@habrahabr" />
  <meta property="al:android:url" content="habrahabr://post/55922" />
<meta property="al:android:app_name" content="Habrahabr" />
<meta property="al:android:package" content="ru.habrahabr" />
<meta property="al:windows_phone:url" content="habrahabr://post/55922" />
<meta property="al:windows_phone:app_name" content="Habrahabr" />
<meta property="al:windows_phone:app_id" content="460a6bd6-8955-470f-935e-9ea1726a6060" />
  <link rel="canonical" href="https://habrahabr.ru/post/55922/"/>
  <link rel="alternate" media="only screen and (max-width: 640px)" href="https://m.habrahabr.ru/post/55922/" >



<meta name='yandex-verification' content='71593b225aeafc4e' />
<meta name='referrer' content='unsafe-url' />
<meta name="pocket-site-verification" content="ed24b2b9721edf0a282c5b4a3232c4" />


<style type="text/css">
  @font-face{font-family:'Fira Sans';font-style:normal;font-weight:400;src:url(/fonts/0/FiraSans/hg-FiraSans-Regular.eot);src:local("Fira Sans"),local("FiraSans-Regular"),url(/fonts/0/FiraSans/hg-FiraSans-Regular.eot?#iefix) format("embedded-opentype"),url(/fonts/0/FiraSans/hg-FiraSans-Regular.woff2) format("woff2"),url(/fonts/0/FiraSans/hg-FiraSans-Regular.woff) format("woff"),url(/fonts/0/FiraSans/hg-FiraSans-Regular.ttf) format("truetype")}@font-face{font-family:'Fira Sans';font-style:normal;font-weight:500;src:url(/fonts/0/FiraSans/hg-FiraSans-Medium.eot);src:local("Fira Sans Medium"),local("FiraSans-Medium"),url(/fonts/0/FiraSans/hg-FiraSans-Medium.eot?#iefix) format("embedded-opentype"),url(/fonts/0/FiraSans/hg-FiraSans-Medium.woff2) format("woff2"),url(/fonts/0/FiraSans/hg-FiraSans-Medium.woff) format("woff"),url(/fonts/0/FiraSans/hg-FiraSans-Medium.ttf) format("truetype")}
</style>

  <link href="https://habracdn.net/habr/styles/1485793001/_build/post_common_css.css" rel="stylesheet" media="all" />
  <link href="https://habracdn.net/habr/styles/1485793001/users/all.css" rel="stylesheet" media="all" />

<link href="https://habracdn.net/habr/styles/1485793001/_build/global_main.css" rel="stylesheet" media="all" />




<meta name='yandex-verification' content='67d46b975fa41645' />

<meta content='Хабрахабр' name='apple-mobile-web-app-title'>

<link rel="apple-touch-icon-precomposed" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png" />
<link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16" />
<meta name="application-name" content="Хабрахабр"/>
<meta name="msapplication-TileColor" content="#FFFFFF" />
<meta name="msapplication-TileImage" content="mstile-144x144.png" />

  <link title="Хабрахабр / Комментарии к публикации «Range, TextRange и Selection»" type="application/rss+xml" rel="alternate" href="https://habrahabr.ru/rss/post/55922/"/>

<script>
  (function(){'use strict';var f,g=[];function l(a){g.push(a);1==g.length&&f()}function m(){for(;g.length;)g[0](),g.shift()}f=function(){setTimeout(m)};function n(a){this.a=p;this.b=void 0;this.f=[];var b=this;try{a(function(a){q(b,a)},function(a){r(b,a)})}catch(c){r(b,c)}}var p=2;function t(a){return new n(function(b,c){c(a)})}function u(a){return new n(function(b){b(a)})}function q(a,b){if(a.a==p){if(b==a)throw new TypeError;var c=!1;try{var d=b&&b.then;if(null!=b&&"object"==typeof b&&"function"==typeof d){d.call(b,function(b){c||q(a,b);c=!0},function(b){c||r(a,b);c=!0});return}}catch(e){c||r(a,e);return}a.a=0;a.b=b;v(a)}}
  function r(a,b){if(a.a==p){if(b==a)throw new TypeError;a.a=1;a.b=b;v(a)}}function v(a){l(function(){if(a.a!=p)for(;a.f.length;){var b=a.f.shift(),c=b[0],d=b[1],e=b[2],b=b[3];try{0==a.a?"function"==typeof c?e(c.call(void 0,a.b)):e(a.b):1==a.a&&("function"==typeof d?e(d.call(void 0,a.b)):b(a.b))}catch(h){b(h)}}})}n.prototype.g=function(a){return this.c(void 0,a)};n.prototype.c=function(a,b){var c=this;return new n(function(d,e){c.f.push([a,b,d,e]);v(c)})};
  function w(a){return new n(function(b,c){function d(c){return function(d){h[c]=d;e+=1;e==a.length&&b(h)}}var e=0,h=[];0==a.length&&b(h);for(var k=0;k<a.length;k+=1)u(a[k]).c(d(k),c)})}function x(a){return new n(function(b,c){for(var d=0;d<a.length;d+=1)u(a[d]).c(b,c)})};window.Promise||(window.Promise=n,window.Promise.resolve=u,window.Promise.reject=t,window.Promise.race=x,window.Promise.all=w,window.Promise.prototype.then=n.prototype.c,window.Promise.prototype["catch"]=n.prototype.g);}());

  (function(){function l(a,b){document.addEventListener?a.addEventListener("scroll",b,!1):a.attachEvent("scroll",b)}function m(a){document.body?a():document.addEventListener?document.addEventListener("DOMContentLoaded",function c(){document.removeEventListener("DOMContentLoaded",c);a()}):document.attachEvent("onreadystatechange",function k(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",k),a()})};function q(a){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(a));this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
  this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)}
  function w(a,b){a.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+b+";"}function x(a){var b=a.a.offsetWidth,c=b+100;a.f.style.width=c+"px";a.c.scrollLeft=c;a.b.scrollLeft=a.b.scrollWidth+100;return a.g!==b?(a.g=b,!0):!1}function z(a,b){function c(){var a=k;x(a)&&null!==a.a.parentNode&&b(a.g)}var k=a;l(a.b,c);l(a.c,c);x(a)};function A(a,b){var c=b||{};this.family=a;this.style=c.style||"normal";this.weight=c.weight||"normal";this.stretch=c.stretch||"normal"}var B=null,C=null,D=null;function H(){if(null===C){var a=document.createElement("div");try{a.style.font="condensed 100px sans-serif"}catch(b){}C=""!==a.style.font}return C}function I(a,b){return[a.style,a.weight,H()?a.stretch:"","100px",b].join(" ")}
  A.prototype.load=function(a,b){var c=this,k=a||"BESbswy",y=b||3E3,E=(new Date).getTime();return new Promise(function(a,b){null===D&&(D=!!document.fonts);if(D){var J=new Promise(function(a,b){function e(){(new Date).getTime()-E>=y?b():document.fonts.load(I(c,'"'+c.family+'"'),k).then(function(c){1<=c.length?a():setTimeout(e,25)},function(){b()})}e()}),K=new Promise(function(a,c){setTimeout(c,y)});Promise.race([K,J]).then(function(){a(c)},function(){b(c)})}else m(function(){function r(){var b;if(b=
  -1!=f&&-1!=g||-1!=f&&-1!=h||-1!=g&&-1!=h)(b=f!=g&&f!=h&&g!=h)||(null===B&&(b=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),B=!!b&&(536>parseInt(b[1],10)||536===parseInt(b[1],10)&&11>=parseInt(b[2],10))),b=B&&(f==t&&g==t&&h==t||f==u&&g==u&&h==u||f==v&&g==v&&h==v)),b=!b;b&&(null!==d.parentNode&&d.parentNode.removeChild(d),clearTimeout(G),a(c))}function F(){if((new Date).getTime()-E>=y)null!==d.parentNode&&d.parentNode.removeChild(d),b(c);else{var a=document.hidden;if(!0===a||
  void 0===a)f=e.a.offsetWidth,g=n.a.offsetWidth,h=p.a.offsetWidth,r();G=setTimeout(F,50)}}var e=new q(k),n=new q(k),p=new q(k),f=-1,g=-1,h=-1,t=-1,u=-1,v=-1,d=document.createElement("div"),G=0;d.dir="ltr";w(e,I(c,"sans-serif"));w(n,I(c,"serif"));w(p,I(c,"monospace"));d.appendChild(e.a);d.appendChild(n.a);d.appendChild(p.a);document.body.appendChild(d);t=e.a.offsetWidth;u=n.a.offsetWidth;v=p.a.offsetWidth;F();z(e,function(a){f=a;r()});w(e,I(c,'"'+c.family+'",sans-serif'));z(n,function(a){g=a;r()});
  w(n,I(c,'"'+c.family+'",serif'));z(p,function(a){h=a;r()});w(p,I(c,'"'+c.family+'",monospace'))})})};"undefined"!==typeof module?module.exports=A:(window.FontFaceObserver=A,window.FontFaceObserver.prototype.load=A.prototype.load);}());

  (function( w ){
    if( w.document.documentElement.className.indexOf( "fonts-loaded" ) > -1 ){ return; }

    var html = document.documentElement;
    var FS400 = new w.FontFaceObserver("Fira Sans", { weight: 400 });
    var FS500 = new w.FontFaceObserver("Fira Sans", { weight: 500 });

    Promise.all([ FS400.check, FS500.check ]).then(function() {
      html.classList.add('fonts-loaded');
      sessionStorage.fontsLoaded = true;
      console.log('fonts-loaded');
    }).catch(function () {
      sessionStorage.fontsLoaded = false;
      console.log('fonts-unloaded');
    });

    if (sessionStorage.fontsLoaded) {
      html.classList.add('fonts-loaded');
    }
  }(this));
</script>
<script src="https://habracdn.net/habr/javascripts/1485793001/libs/jquery-1.8.3.min.js"></script>
  
  <script >var N = 5; var ar_duo1 = Math.floor(Math.random()*N+1);</script>
  <script type="text/javascript" src="https://habracdn.net/habr/javascripts/1485793001/libs/adriver.core.2.js"></script>

<script src="https://habracdn.net/habr/javascripts/1485793001/_parts/advertising.js"></script>
<script type="text/javascript">
  if (typeof adriver == 'undefined'){ var adb1 = 'yes';}

    var user_type = 'guest';

  var page_type = "publish_ugc";

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-726094-1',  'auto');
  ga('create', 'UA-726094-24', 'auto', {'name': 'HGM'});

  ga('require', 'displayfeatures');
  ga('set', 'dimension1', user_type); // user type - guest/readonly/habrauser


  ga('set', 'dimension4', adb1);

  ga('set', 'dimension5', page_type);


   (function() {
     var win = window;
     var removeUtms = function(){
       var location = win.location;
       if (location.search.indexOf('utm_') != -1 && history.replaceState) {
         history.replaceState({}, '', window.location.toString().replace(/(\&|\?)utm([_a-z0-9=]+)/g, ""));
       }
     };
     ga('send', 'pageview', { 'hitCallback': removeUtms });
   })();

  ga('HGM.set', 'dimension1', user_type);
  ga('HGM.set', 'dimension2', "habrahabr");
  ga('HGM.send', 'pageview');
</script>

<script>
  var adcm_config ={
    id:1034,
    platformId: 34,
    
    tags: ['hub_javascript', 'g_scripting_languages'],
    init: function () {
      window.adcm.call();
    }
  };
</script>
<script src="https://tag.digitaltarget.ru/adcm.js" async></script>
  </head>

  <body class="nl">
    <div class="layout">
      <div id="TMpanel">
  <div class="container">
    <div class="bmenu">
      <a href="https://tmfeed.ru?utm_source=tm_habrahabr&utm_medium=tm_top_panel&utm_campaign=tm_promo">TM Feed</a>
      <a href="https://habrahabr.ru?utm_source=tm_habrahabr&utm_medium=tm_top_panel&utm_campaign=tm_promo" class="current">Хабрахабр</a>
      <a href="https://geektimes.ru?utm_source=tm_habrahabr&utm_medium=tm_top_panel&utm_campaign=tm_promo">Geektimes</a>
      <a href="https://toster.ru?utm_source=tm_habrahabr&utm_medium=tm_top_panel&utm_campaign=tm_promo">Тостер</a>
      <a href="https://moikrug.ru?utm_source=tm_habrahabr&utm_medium=tm_top_panel&utm_campaign=tm_promo">Мой круг</a>
      <a href="https://freelansim.ru?utm_source=tm_habrahabr&utm_medium=tm_top_panel&utm_campaign=tm_promo">Фрилансим</a>
    </div>
      <div class="bmenu_inner" style="display:inline-block!important;visibility:visible!important;">
        <span class="bmenu__label">Спецпроекты:</span>
        <span class="bmenu slink"></span>
        <span id="adriver_banner_465568687"></span>
      </div>
  </div>
</div>

      <div class="layout__navbar">
        <div class="main-navbar">
  <div class="main-navbar__section main-navbar__section_left" data-style="display: flex;">
    <a href="/" class="logo">
      <svg class="icon-svg icon-svg_logo-habrahabr" width="181" height="32" viewBox="0 0 181 32" aria-hidden="true" aria-labelledby="title" version="1.1" role="img"><title>Хабрахабр</title><path d="M24.736 1.044h-8.582L12.53 6.168 8.91 1.044H.325l7.898 11.194L0 23.888h8.583l3.948-5.58 3.95 5.58h8.583l-8.256-11.65zM34.033 7.082c-3.133 0-6.036.88-8.256 2.61l2.87 3.428c1.502-.98 3.754-1.535 5.255-1.535 1.372 0 2.577.36 2.577 2.09v.49c-6.56 0-11.096 1.142-11.096 5.58 0 3.133 2.252 4.633 5.71 4.633 1.665 0 3.885-.913 5.386-2.61v2.12h6.07V12.696c0-4.765-4.73-5.613-8.516-5.613zm2.448 11.455c-.912 1.21-1.89 1.73-2.773 1.73-1.24 0-1.6-.654-1.6-1.274 0-1.533 1.96-2.087 4.373-2.087v1.63zM53.937 8.746c-1.47 0-3.818.62-4.863 1.894.294-2.448 2.023-3.655 5.32-4.308 1.534-.294 5.155-.98 7.18-1.402L60.463 0c-2.546.62-4.864 1.143-7.508 1.633-6.657 1.24-8.125 5.156-8.125 12.14 0 6.658 2.743 10.608 8.813 10.608 5.188 0 8.615-3.426 8.615-8.517 0-3.983-2.87-7.116-8.32-7.116zm-.39 10.28c-1.437 0-2.644-1.24-2.644-2.675s1.207-2.675 2.643-2.675c1.436 0 2.643 1.24 2.643 2.676s-1.208 2.677-2.644 2.677zM74.82 7.082c-1.664 0-3.46 1.044-4.21 2.61v-2.12h-6.07v22.974h6.07v-8.778c.752 1.567 2.546 2.61 4.21 2.61 4.765 0 7.343-3.883 7.343-8.648 0-4.764-2.577-8.647-7.343-8.647zm-1.957 11.552c-.88 0-1.697-.423-2.252-1.108v-3.622c.555-.653 1.373-1.076 2.253-1.076 1.567 0 2.905 1.273 2.905 2.905 0 1.564-1.338 2.902-2.905 2.902zM92.767 7.082c-3.133 0-6.038.88-8.256 2.61l2.872 3.428c1.5-.98 3.753-1.535 5.254-1.535 1.372 0 2.58.36 2.58 2.09v.49c-6.56 0-11.098 1.142-11.098 5.58 0 3.133 2.252 4.633 5.71 4.633 1.665 0 3.885-.913 5.387-2.61v2.12h6.068V12.696c0-4.765-4.732-5.613-8.516-5.613zm2.448 11.455c-.915 1.21-1.894 1.73-2.775 1.73-1.24 0-1.6-.654-1.6-1.274 0-1.533 1.96-2.087 4.375-2.087v1.63zM122.723 7.57h-7.703l-2.055 4.276-2.057-4.275h-7.7l5.58 7.997-5.874 8.32h7.702l2.35-4.306 2.35 4.308h7.702l-6.528-8.32zM132.967 7.082c-3.133 0-6.038.88-8.257 2.61l2.873 3.428c1.503-.98 3.753-1.535 5.255-1.535 1.37 0 2.58.36 2.58 2.09v.49c-6.56 0-11.098 1.142-11.098 5.58 0 3.133 2.252 4.633 5.71 4.633 1.665 0 3.885-.913 5.386-2.61v2.12h6.068V12.696c0-4.765-4.732-5.613-8.516-5.613zm2.448 11.455c-.913 1.21-1.894 1.73-2.775 1.73-1.24 0-1.6-.654-1.6-1.274 0-1.533 1.96-2.087 4.375-2.087v1.63zM152.87 8.746c-1.468 0-3.817.62-4.862 1.894.294-2.448 2.023-3.655 5.32-4.308 1.536-.294 5.157-.98 7.18-1.402L159.397 0c-2.546.62-4.864 1.143-7.506 1.633-6.657 1.24-8.125 5.156-8.125 12.14 0 6.658 2.742 10.608 8.81 10.608 5.19 0 8.617-3.426 8.617-8.517 0-3.983-2.873-7.116-8.323-7.116zm-.39 10.28c-1.437 0-2.643-1.24-2.643-2.675s1.206-2.675 2.643-2.675c1.436 0 2.643 1.24 2.643 2.676 0 1.437-1.207 2.677-2.643 2.677zM173.754 7.082c-1.664 0-3.46 1.044-4.21 2.61v-2.12h-6.07v22.974h6.07v-8.778c.75 1.567 2.546 2.61 4.21 2.61 4.764 0 7.343-3.883 7.343-8.648 0-4.764-2.58-8.647-7.343-8.647zm-1.958 11.552c-.88 0-1.697-.423-2.252-1.108v-3.622c.554-.653 1.37-1.076 2.252-1.076 1.565 0 2.905 1.273 2.905 2.905 0 1.564-1.34 2.902-2.904 2.902z"/></svg>
    </a>
    <ul class="nav-links" id="navbar-links">
  <li class="nav-links__item">
    <a href="/" class="nav-links__item-link ">Публикации</a>
  </li>
  <li class="nav-links__item">
    <a href="/hubs/" class="nav-links__item-link ">Хабы</a>
  </li>
  <li class="nav-links__item">
    <a href="/companies/" class="nav-links__item-link ">Компании</a>
  </li>
  <li class="nav-links__item">
    <a href="/users/" class="nav-links__item-link ">Пользователи</a>
  </li>
  <li class="nav-links__item">
    <a href="/sandbox/" class="nav-links__item-link ">Песочница</a>
  </li>
</ul>
    <form action="/search/#h" method="get" class="search-form" id="search-form">
  <!-- Я вернулся братиш, после стольких лет разлуки:) -->
  <button type="button" class="btn btn_navbar_search" id="search-form-btn">
    <svg class="icon-svg icon-svg_navbar-search" width="32" height="32" viewBox="0 0 32 32" aria-hidden="true" version="1.1" role="img"><path d="M21.416 13.21c0 4.6-3.65 8.34-8.14 8.34S5.11 17.81 5.11 13.21c0-4.632 3.65-8.373 8.167-8.373 4.488 0 8.14 3.772 8.14 8.372zm1.945 7.083c1.407-2.055 2.155-4.57 2.155-7.084C25.515 6.277 20.04.665 13.277.665S1.04 6.278 1.04 13.21c0 6.93 5.475 12.542 12.237 12.542 2.454 0 4.907-.797 6.942-2.208l7.6 7.79 3.14-3.22-7.6-7.82z"/></svg>
  </button>
  <label class="search-form__field-wrapper">
    <input type="text" name="q" class="search-form__field" id="search-form-field" placeholder="Поиск" tabindex="-1"/>
    <button type="button" class="btn btn_search-clear" id="search-form-clear">
      <svg class="icon-svg icon-svg_navbar-close-search" width="31" height="32" viewBox="0 0 31 32" aria-hidden="true" version="1.1" role="img"><path d="M26.67 0L15.217 11.448 3.77 0 0 3.77l11.447 11.45L0 26.666l3.77 3.77L15.218 18.99l11.45 11.448 3.772-3.77-11.448-11.45L30.44 3.772z"/></svg>

    </button>
  </label>
</form>
  </div>

  <div class="main-navbar__section main-navbar__section_right" data-style="display: flex;">
      <a href="https://habrahabr.ru/auth/login/" id="login" class="btn btn_x-large btn_navbar_login">Войти</a>
      <a href="https://habrahabr.ru/auth/register/" class="btn btn_x-large btn_navbar_registration">Регистрация</a>


  </div>
</div>
      </div>
      <div class="layout__base">
        

          <div class="profile-header js-user_33108">

  <div class="profile-header__summary author-info author-info_profile ">
    <a href="/users/bur/" class="author-info__image" onclick="if (typeof ga === 'function') { ga('send', 'event', 'author_info_top', 'profile', 'bur');}">
        <span class="user-pic_default user-pic_default_47 user-pic_blue"></span>

    </a>

    <div class="author-info__desc">
      <div class="author-info__username">
         <a href="/users/bur/" class="author-info__name" onclick="if (typeof ga === 'function') { ga('send', 'event', 'author_info_top', 'profile', 'bur');}">Александр</a> 
        <a href="/users/bur/" class="author-info__nickname" onclick="if (typeof ga === 'function') { ga('send', 'event', 'author_info_top', 'profile', 'bur');}">@bur</a>
        
      </div>
        <div class="author-info__specialization">
          Пользователь
        </div>
    </div>
  </div>

    <div class="profile-header__stats">

      <div class="karma__widjet voting-wjt voting-wjt_user-profile js-karma  ">

        <div class="voting-wjt__counter js-karma-mark voting-wjt__counter_positive " title="112 голосов">
          <div class="voting-wjt__counter-score js-karma_num">104,0</div>
          <div class="voting-wjt__label">карма</div>
        </div>

      </div>

      <div class="statistic statistic_user-rating" title="Рейтинг пользователя">
        <div class="statistic__value statistic__value_magenta">0,0</div>
        <div class="statistic__label">рейтинг</div>
      </div>

    </div>


</div>

  <div class="content_wrapper column-wrapper_content">
    <div class="column-wrapper js-sticky-wrapper">
      <div class="content_left js-content_left">
          <div class="tabs">
    <ul class="tabs-menu tabs-menu_habrahabr">
          <li class="tabs-menu__item tabs-menu__item_user-profile tabs-menu__item_inline">
            <a href="https://habrahabr.ru/users/bur/" class="tab-item tab-item_stacked "  >
              <span class="tab-item__value stats">
                <span class="stats__counters stats__counters_big">
                  <strong class="counter"></strong>
                </span>
                <span class="stats__value">Профиль</span>
            </a>
          </li>
          <li class="tabs-menu__item tabs-menu__item_user-profile tabs-menu__item_inline">
            <a href="https://habrahabr.ru/users/bur/topics/" class="tab-item tab-item_stacked tab-item_current"  >
              <span class="tab-item__value stats">
                <span class="stats__counters stats__counters_big">
                  <strong class="counter">10</strong>
                </span>
                <span class="stats__value">Публикации</span>
            </a>
          </li>
          <li class="tabs-menu__item tabs-menu__item_user-profile tabs-menu__item_inline">
            <a href="https://habrahabr.ru/users/bur/comments/" class="tab-item tab-item_stacked "  >
              <span class="tab-item__value stats">
                <span class="stats__counters stats__counters_big">
                  <strong class="counter">182</strong>
                </span>
                <span class="stats__value">Комментарии</span>
            </a>
          </li>
          <li class="tabs-menu__item tabs-menu__item_user-profile tabs-menu__item_inline">
            <a href="https://habrahabr.ru/users/bur/favorites/" class="tab-item tab-item_stacked "  >
              <span class="tab-item__value stats">
                <span class="stats__counters stats__counters_big">
                  <strong class="counter">93</strong>
                </span>
                <span class="stats__value">Избранное</span>
            </a>
          </li>
          <li class="tabs-menu__item tabs-menu__item_user-profile tabs-menu__item_inline">
            <a href="https://habrahabr.ru/users/bur/subscription/followers/" class="tab-item tab-item_stacked "  >
              <span class="tab-item__value stats">
                <span class="stats__counters stats__counters_big">
                  <strong class="counter">21</strong>
                </span>
                <span class="stats__value">Подписчики</span>
            </a>
          </li>
    </ul>

  </div>


        <div class="post_show">
          
    <div class="post post_full" id="post_55922">
  <div class="post__header">
    <span class="post__time_published">
       30 марта 2009 в 17:40 
    </span>

    <h1 class="post__title">
      <a href="https://habrahabr.ru/flows/develop/" class="post__flow" onclick="if (typeof ga === 'function') { ga('send', 'event', 'flow', 'post page', 'Разработка'); }">Разработка</a><span class="post__title-arrow">&nbsp;&rarr;</span>
      <span>Range, TextRange и Selection</span>
      











    </h1>

      <div class="hubs">
          <a href="https://habrahabr.ru/hub/javascript/" class="hub " title="Вы не подписаны на этот хаб" onclick="if (typeof ga === 'function') { ga('send', 'event', 'hub', 'post page', 'JavaScript'); }">JavaScript</a><span class="profiled_hub" title="Профильный хаб">*</span>
      </div>
  </div>

  <div class="post__body post__body_full">
    <div class="content html_format">Многим JavaScript-разработчикам приходилось сталкиваться с объектами, перечисленными в заголовке, например, при решении следующих задач:<br/>
 — создание визуальных редакторов (wysiwyg),<br/>
 — поиск в окне браузера,<br/>
 — выставление BB-кода,<br/>
 и т.д.<br/>
<br/>
В этой статье автором предпринята попытка собрать перевод документации об этих объектах в одном месте + написать небольшие сопроводительные примеры. Перевод вольный, не дословный, так что если встретите неточность или корявую формулировку &mdash; пишите в комментариях.<br/>
<br/>
В целом пост носит справочный характер, и, надеюсь, кому-то упростит разработку.<br/>
<br/>
<a name="habracut"></a><h2>1. Range</h2><br/>
 <strong>Range</strong> &mdash; это объект, соответствующий фрагменту документа, который может включать узлы и участки текста из этого документа. Наиболее подробно о Range-объектах изложено в <a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html">DOM Range</a>.<br/>
<br/>
Чтобы понять о чем речь, обратимся к самому простому случаю Range-объектов, который будет подробно рассмотрен ниже, &mdash; к выделениям. В приводимом ниже примере выделите несколько слов в предложении. Тем самым вы будете создавать объекты, похожие на Range. В нашем примере мы получим текстовое содержимое выделяемой вами области.<br/>
<br/>
<a href="http://2007.fastcoder.ru/articles/?aid=609#demo1">Ссылка на пример</a><br/>
<br/>
Но такие области можно создавать не только с помощью пользовательского выделения, но и из JavaScript-сценария, выполняя с ними определенные манипуляции. Однако, написать простой иллюстрирующий код сразу не выйдет, т.к. есть одно НО &mdash; Internet Explorer. В Micsosoft создали собственную реализацию &mdash; <a href="http://msdn.microsoft.com/en-us/library/ms535872.aspx">объект TextRange</a>. Разберем каждую реализацию по-отдельности.<br/>
<br/>
<h3>1.1 DOM-реализация Range <img src="https://habrastorage.org/getpro/habr/post_images/d86/306/e47/d86306e474a89377a537d48d365846da.gif" width="16" height="16" alt="Mozilla Firefox supported"/> <img src="https://habrastorage.org/getpro/habr/post_images/576/500/807/57650080760b39c44fb782b7193c9005.gif" width="16" height="16" alt="Chrome supported"/> <img src="https://habrastorage.org/getpro/habr/post_images/b2d/f7a/89d/b2df7a89dcf08d3344528b3282d5ff71.gif" width="16" height="16" alt="Opera supported"/> <img src="https://habrastorage.org/getpro/habr/post_images/32b/3fa/755/32b3fa7553da67019db6d386f590713e.gif" width="16" height="16" alt="Safari supported"/></h3><br/>
 Range состоит из двух граничных точек (boundary-points), соответствующих началу и концу области. Позиция любой граничной точки определяется в документе с помощью двух свойств: узел (node) и смещение (offset). Контейнером (container) называют узел, содержащий граничную точку. Сам контейнер и все его предки называются родительскими контейнерами (ancestor containers) для граничной точки. Родительский контейнер, включающий обе граничные точки, называют рут-контейнером (root container).<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/post_images/c14/a5b/8b5/c14a5b8b526c93bd88904c1cfcaa646e.gif" width="358" height="35" alt="Range nodes"/><br/>
<br/>
На изображении выше граничные точки выделения лежат в текстовых узлах (#text1 и #text2), которые являются контейнерами. Для левой границы родительскими контейнерами являются #text1, H1, BODY, для правой &mdash; #text2, P, BODY. Общий родитель для обоих граничных точек — BODY, этот элемент является рут-контейнером.<br/>
<br/>
Если контейнер является текстовым узлом, то смещение определяется в символах от начала ноды. Если контейнер является элементом (Document, DocumentFragment, Element...), то смещение определяется в дочерних узлах.<br/>
<br/>
Смотрим на иллюстрацию (<a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#td-boundarypoint">источник</a>):<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/post_images/05e/bc5/3dc/05ebc53dc9a35802d729f0d81ed5a5d6.gif" width="357" height="343" alt="Range Example"/><br/>
<br/>
Граничные точки Range-объекта <b>s1</b> лежат в текстовых узлах, поэтому смещение задается в символах от начала узла. Для <b>s2</b> граничные точки расставлены так, что включают весь абзац &lt;p&gt;Blah xyz&lt;/p&gt;, поэтому контейнером является элемент BODY, и смещение считается в позициях дочерних узлов.<br/>
<br/>
Range-объекты создаются с помощью метода creareRange, который вызывается в контексте рут-контейнера или документа. Объект при этом создается пустой, и граничные точки задаются методами setStart и setEnd объекта. Смотрим пример:<br/>
<br/>
<code><font color="black"><font color="#0000ff">&lt;</font><font color="#800000">div</font> <font color="#ff0000">id</font><font color="#0000ff">=&quot;ex2&quot;</font><font color="#0000ff">&gt;</font><br/>
 &nbsp;&nbsp;<font color="#0000ff">&lt;</font><font color="#800000">h2</font><font color="#0000ff">&gt;</font>Соз|даем Range-объекта<font color="#0000ff">&lt;/</font><font color="#800000">h2</font><font color="#0000ff">&gt;</font><br/>
 &nbsp;&nbsp;<font color="#0000ff">&lt;</font><font color="#800000">p</font><font color="#0000ff">&gt;</font>От третье|го символа заголовка до десятого символа это абзаца.<font color="#0000ff">&lt;/</font><font color="#800000">p</font><font color="#0000ff">&gt;</font><br/>
 <font color="#0000ff">&lt;/</font><font color="#800000">div</font><font color="#0000ff">&gt;</font></font></code><br/>
<br/>
<code><font color="black">$domRange = {<br/>
 &nbsp;&nbsp;create : <font color="#0000ff">function</font>() {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Найдем root-контейнер</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> root =&nbsp;&nbsp;<font color="#0000ff">document</font>.getElementById(<font color="#A31515">'ex2'</font>);<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Найдем контейнеры граничных точек (в данном случае тестовые)</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> start =&nbsp;&nbsp;root.getElementsByTagName(<font color="#A31515">'h2'</font>)[0].firstChild;<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> end =&nbsp;&nbsp;root.getElementsByTagName(<font color="#A31515">'p'</font>)[0].firstChild;<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> ( root.createRange ) {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Создаем Range</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> rng = root.createRange();<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Задаем верхнюю граничную точку, передав контейнер и смещение</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng.setStart( start, 3 );<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Аналогично для нижней границы</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng.setEnd( end, 10 );<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Теперь мы можем вернуть текст, который содержится в полученной области</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> rng.toString();<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;} <font color="#0000ff">else</font> <br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> <font color="#A31515">'Вероятно, у вас Internet Explorer, смотрите реализацию TextRange ниже'</font>;<br/>
 &nbsp;&nbsp;}<br/>
 }</font></code><br/>
<br/>
<a href="http://2007.fastcoder.ru/articles/?aid=609#demo2">Пример в действии</a>.<br/>
<br/>
Рассмотрим вкратце <a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Interface">свойства и методы Range</a>:<br/>
 <ul>
<li>Свойство <strong>commonAncestorContainer</strong> вернет ссылку на наиболее вложенный рут-контейнер.</li>
<li>Свойство <strong>startContainer</strong> (<strong>endContainer</strong>) вернет ссылку на контейнер верхней (нижней) граничной точки.</li>
<li>Свойство <strong>startOffset</strong> (<strong>endOffset</strong>) вернет смещение для верхней (нижней) граничной точки.</li>
<li>Свойство <strong>collapsed</strong> вернет true, если граничные точки имеют одинаковые контейнеры и смещение (false в противном случае).</li>
</ul><br/>
 <ul>
<li>Метод <strong>setStart</strong> (<strong>setEnd</strong>) задает контейнер (ссылка на узел) и смещение (целочисленное значение) для соот-их граничных точек. Пример выше.</li>
<li>Методы <strong>setStartBefore</strong>, <strong>setStartAfter</strong>, <strong>setEndBefore</strong>, <strong>setEndAfter</strong> принимают в качестве единственного аргумента ссылку на узел и устанавливают граничные точки в соот-ии с естественной границей переданного узла. Например:<br/>
 <code><font color="black"><font color="#0000ff">&lt;</font><font color="#800000">span</font> <font color="#ff0000">id</font><font color="#0000ff">=&quot;s1&quot;</font><font color="#0000ff">&gt;</font>First<font color="#0000ff">&lt;/</font><font color="#800000">span</font><font color="#0000ff">&gt;</font><br/>
 <font color="#0000ff">&lt;</font><font color="#800000">span</font> <font color="#ff0000">id</font><font color="#0000ff">=&quot;s2&quot;</font><font color="#0000ff">&gt;</font>Second<font color="#0000ff">&lt;/</font><font color="#800000">span</font><font color="#0000ff">&gt;</font></font></code><br/>
 <code><font color="black"><font color="#0000ff">var</font> rng = <font color="#0000ff">document</font>.createRange();<br/>
 <font color="#008000">// Установит верхнюю граничную точку по левой границе спана #s1</font><br/>
 rng.setStartBefore( <font color="#0000ff">document</font>.getElementById(<font color="#A31515">'s1'</font>) );<br/>
 <font color="#008000">// Установит нижнюю граничную точку по правой границе спана #s2</font><br/>
 rng.setEndAfter( <font color="#0000ff">document</font>.getElementById(<font color="#A31515">'s2'</font>) );</font></code><br/>
 </li>
<li>Методы <strong>selectNode</strong> и <strong>selectNodeContents</strong> позволяют создать Range-объект по границам узла, ссылку на который они принимают в качестве единственного аргумента. При использовании selectNode передаваемый узел также войдет в Range, в то время как selectNodeContents создаст объект только из содержимого узла:<br/>
 <img src="https://habrastorage.org/getpro/habr/post_images/5be/bbe/f20/5bebbef2012d4adf996f7e05ba36f6e1.gif" width="358" height="55" alt="Select Node"/></li>
<li>Метод <strong>collapse</strong> объединяет граничные точки Range-объекта. В качестве единственного аргумента принимает булево значение (true &mdash для объединения в верхней точке, false &mdash в нижней). По-умолчанию true.</li>
<li>Метод <strong>toString</strong> вернет текстовое содержимое Range-объекта.</li>
<li>Метод <strong>cloneContents</strong> вернет копию содержимого Range-объекта в виде фрагмента документа.</li>
<li>Метод <strong>cloneRange</strong> вернет копию самого Range-объекта.</li>
<li>Метод <strong>deleteContents</strong> удаляет всё содержимое Range-объекта.</li>
<li>Метод <strong>detach</strong> извлекает текущий объект из DOM, так что на него больше нельзя сослаться.</li>
<li>Метод <strong>insertNode</strong> принимает в качестве единственного аргумента ссылку на узел (или фрагмент документа) и всталяет его в содержимое Range-объекта в начальной точке.</li>
<li>Метод <strong>extractContents</strong> вырезает содержимое Range-объекта и возвращает ссылку на полученный фрагмент документа.</li>
<li>Метод <strong>surroundContents</strong> помещает всё содержимое текущего Range-объекта в новый родительский элемент, ссылка на который принимается в качестве единственного аргумента.</li>
<li>Метод <strong>compareBoundaryPoints</strong> используется для сравнения граничных точек.</li>
</ul><br/>
<br/>
Чтобы отвлечься и закрепить знания, решим небольшую задачку. Найдем в текстовом узле фразу и подсветим её синим фоном.<br/>
<br/>
<code><font color="black"><font color="#0000ff">&lt;</font><font color="#800000">div</font> <font color="#ff0000">id</font><font color="#0000ff">=&quot;ex3&quot;</font><font color="#0000ff">&gt;</font><br/>
 &nbsp;&nbsp;Найдем в этом тексте слово &quot;бабуля&quot; и подсветим его синим фоном<br/>
 <font color="#0000ff">&lt;/</font><font color="#800000">div</font><font color="#0000ff">&gt;</font></font></code><br/>
<br/>
<code><font color="black">$domRange.highlight = <font color="#0000ff">function</font>( text ) {<br/>
 &nbsp;&nbsp;<font color="#008000">// Получим текстовый узел</font><br/>
 &nbsp;&nbsp;<font color="#0000ff">var</font> root = <font color="#0000ff">document</font>.getElementById(<font color="#A31515">'ex3'</font>).firstChild;<br/>
 &nbsp;&nbsp;<font color="#008000">// и его содержимое</font><br/>
 &nbsp;&nbsp;<font color="#0000ff">var</font> content = root.nodeValue;<br/>
 &nbsp;&nbsp;<font color="#008000">// Проверим есть ли совпадения с переданным текстом</font><br/>
 &nbsp;&nbsp;<font color="#0000ff">if</font> ( content.indexOf( text ) != -1 ) {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> ( <font color="#0000ff">document</font>.createRange ) {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Если есть совпадение, и браузер поддерживает Range, создаем объект</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> rng = <font color="#0000ff">document</font>.createRange();<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Ставим верхнюю границу по индексу совпадения,</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng.setStart( root, content.indexOf( text ) );<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// а нижнюю по индексу + длина текста</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng.setEnd( root, content.indexOf( text ) + text.length );<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Создаем спан с синим фоном</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> highlightDiv = <font color="#0000ff">document</font>.createElement(<font color="#A31515">'span'</font>);<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;highlightDiv.style.backgroundColor = <font color="#A31515">'blue'</font>;<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Обернем наш Range в спан</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rng.surroundContents( highlightDiv );<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;} <font color="#0000ff">else</font> <br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(<font color="#A31515">'Вероятно, у вас Internet Explorer, смотрите реализацию TextRange ниже'</font>);<br/>
 &nbsp;&nbsp;} <font color="#0000ff">else</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;alert(<font color="#A31515">'Совпадений не найдено'</font>);<br/>
 }</font></code><br/>
<br/>
<a href="http://2007.fastcoder.ru/articles/?aid=609#demo3">Пример в действии</a>.<br/>
<br/>
С остальными свойствами и методами поэкспериментируйте сами. <br/>
 Перейдем к реализации range в MSIE.<br/>
<br/>
<h3>1.2. TextRange <img src="https://habrastorage.org/getpro/habr/post_images/58e/0d1/ed1/58e0d1ed15240e9c2acf53d14c3214c2.gif" width="16" height="16" alt="Internet Explorer supported"/></h3><br/>
 Объект <strong>TextRange</strong> в реализации MSIE &mdash; это текстовый диапазон нулевой и более длины. У данного диапазона также есть свои границы, «перемещать» которые можно на целое число текстовых едениц: character(символ), word (слово), sentence (предложение). То есть можно взять и сдвинуть границу на 2(5, 8 и т.д.) слова (символа, предложения) вправо (влево). При этом у объекта сохраняются данные о HTML-содержимом диапазона и есть методы взаимодействия с DOM.<br/>
<br/>
Объект TextRange создается с помощью метода <strong>createTextRange</strong>, который можно вызывать в контексте следующих DOM-элементов:<br/>
<br/>
<code>BODY, BUTTON, INPUT type=button, INPUT type=hidden, INPUT type=password, INPUT type=reset, INPUT type=submit, INPUT type=text, TEXTAREA</code><br/>
<br/>
Простой пример с кнопкой:<br/>
<br/>
<code><font color="black"><font color="#0000ff">&lt;</font><font color="#800000">input</font> <font color="#ff0000">id</font><font color="#0000ff">=&quot;buttonId&quot;</font> <font color="#ff0000">type</font><font color="#0000ff">=&quot;button&quot;</font> <font color="#ff0000">value</font><font color="#0000ff">=&quot;Test button&quot;</font> <font color="#0000ff">/&gt;</font></font></code><br/>
<br/>
<code><font color="black">$ieTextRange = {<br/>
 &nbsp;&nbsp;create : <font color="#0000ff">function</font>() {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Найдем кнопку</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> button = <font color="#0000ff">document</font>.getElementById(<font color="#A31515">'buttonId'</font>);<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Если мы в ИЕ</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> ( button.createTextRange && button.createTextRange() != undefined ) {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Создаем TextRange</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> rng = button.createTextRange();<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// И вернем текстовое содержимое полученного объекта</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> rng.text;<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;} <font color="#0000ff">else</font> <br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> <font color="#A31515">'Вероятно, у вас не IE (поздравляем!), смотрите реализацию Range выше'</font>;<br/>
 &nbsp;&nbsp;}<br/>
 }</font></code><br/>
<br/>
<a href="http://2007.fastcoder.ru/articles/?aid=609#demo4">Пример в действии</a>.<br/>
<br/>
Рассмотрим <a href="http://msdn.microsoft.com/en-us/library/ms535872.aspx#">свойства и методы объекта TextRange</a> (не все, только самые необходимые):<br/>
 <ul>
<li>Свойство <strong>boundingWidth</strong> (boundingHeight) вернет ширину (высоту), которую занимает объект TextRange в пикселях.</li>
<li>Свойство <strong>boundingTop</strong> (<strong>boundingLeft</strong>) вернет Y(X)-координату верхнего левого угла тестовой области относительно окна документа.</li>
<li>Свойство <strong>htmlText</strong> вернет HTML-содержимое объекта.</li>
<li>Свойство <strong>text</strong> вернет текстовое содержимое объекта (см. пример выше).</li>
<li>Свойство <strong>offsetTop</strong> (<strong>offsetLeft</strong>) вернет Y(X)-координату верхнего левого угла тестовой области относительно предка.</li>
</ul><br/>
 <ul>
<li>Метод <strong>collapse</strong> объединяет граничные точки диапазона. В качестве единственного аргумента принимает булево значение (true &mdash для объединения в верхней точке, false &mdash в нижней). По-умолчанию true.</li>
<li>Метод <strong>duplicate</strong> клонирует имеющийся текстовый диапазон, возвращая новый, точно такой же.</li>
<li>Метод <strong>expand</strong> расширяет текущий тектовый диапазон до еденицы текста, переданной в качестве единственного текстового аргумента:<br/>
 <code>'character' — символ<br/>
 'word' — слово<br/>
 'sentence' — предложение<br/>
 'textedit' — сворачивает до первоначального диапазона.</code><br/>
 Вернет true (false) в случае успеха (неудачи).<br/>
 </li>
<li>Метод <strong>findText</strong> ищет в диапазоне совпадения с текстовой строкой, передаваемой в качестве первого аргумента (без учета регистра). Если совпадение найдено, то границы диапазона сворачиваются до него. В качестве второго (необязательного) аргумента можно передать целое число, указывающее число символов от верхней точки, в которых нужно производить поиск. Далее в качестве аргументов можно перечислять INT-флаги, которые вам <a href="http://msdn.microsoft.com/en-us/library/ms536422(VS.85).aspx">вряд ли понадобятся</a>.</li>
<li>Метод <strong>getBookmark</strong> возвращает в случае успешного вызова строку, по которой можно будет восстановить текущее состояние текстового диапазона с помощью метода <strong>moveToBookmark</strong>.</li>
<li>Метод <strong>inRange</strong> принимает в качестве аргумента другой TextRange-объект и проверяет, входит ли его текстовый диапазон в диапазон контекстного объекта. Возвращает булево значение.</li>
<li>Метод <strong>isEqual</strong> проверяет является ли текущий TextRange-объект идентичным переданному в качестве аргумента. Возвращает булево значение.</li>
<li>Метод <strong>move(sUnit [, iCount])</strong> сворачивает текущий диапазон до нулевой длины и передвигает на еденицу текста, переданного в качестве первого аргумента (character | word | sentence | textedit). В качестве второго (необязательного) аргумента можно передать число едениц, на которое следует передвинуть диапазон.</li>
<li>Метод <strong>moveEnd</strong> (<strong>moveStart</strong>), аналогично методу move, передвигает верхнюю (нижнюю) границу диапазона на еденицу текста, число которых также можно задать необязательным вторым параметром.</li>
<li>Метод <strong>moveToElementText</strong> принимает в качестве аргумента ссылку на DOM-элемент и выставляет границы диапазона TextRange-объекта по границам полученного элемента.</li>
<li>Метод <strong>moveToPoint</strong> принимает в качестве двух обязательных аргументов X и Y-координаты (в пикселях) относительно верхнего левого угла документа и переносит границы диапазона туда.</li>
<li>Метод <strong>parentElement</strong> вернет ссылку на элемент, который полностью содержит диапазон TextRange-объекта (или null).</li>
<li>Метод <strong>pasteHTML</strong> заменяет HTML-содержимое текущего текстового диапазона на строку, переданную в качестве единственного аргумента.</li>
<li>Метод <strong>select</strong> формирует выделение на основе содержимого TextRange-объекта, о чем мы подробнее поговорим ниже.</li>
<li>Метод <strong>setEndPoint</strong> принимает в качестве обязательных аргументов текстовый указатель и ссылку на другой TextRange-объект, устанавливая в зависимости от значения указателя границы диапазона. Указатели могут быть следующими: 'StartToEnd', 'StartToStart', 'EndToStart', 'EndToEnd'.</li>
</ul><br/>
<br/>
Также к TextRange-объектам применимы команды <a href="http://2007.fastcoder.ru/articles/?aid=172">метода execCommand</a>.<br/>
<br/>
Для закрепления решим задачку по поиску текстового содержимого, аналогичную той, что была выше:<br/>
<br/>
<code><font color="black"><font color="#0000ff">&lt;</font><font color="#800000">div</font> <font color="#ff0000">id</font><font color="#0000ff">=&quot;ex4&quot;</font><font color="#0000ff">&gt;</font><br/>
 &nbsp;&nbsp;Найдем в этом тексте слово &quot;бабуля&quot; и подсветим его синим фоном<br/>
 <font color="#0000ff">&lt;/</font><font color="#800000">div</font><font color="#0000ff">&gt;</font></font></code><br/>
<br/>
<code><font color="black">$ieTextRange.highlight = <font color="#0000ff">function</font>( text ) {<br/>
 &nbsp;&nbsp;<font color="#008000">// Получим ссылку на элемент, в котором будет происходить поиск</font><br/>
 &nbsp;&nbsp;<font color="#0000ff">var</font> root = <font color="#0000ff">document</font>.getElementById(<font color="#A31515">'ex4'</font>);<br/>
 &nbsp;&nbsp;<font color="#008000">// Получим значение его текстового потомка</font><br/>
 &nbsp;&nbsp;<font color="#0000ff">var</font> content = root.firstChild.nodeValue;<br/>
 &nbsp;&nbsp;<font color="#008000">// Если есть совпадение</font><br/>
 &nbsp;&nbsp;<font color="#0000ff">if</font> ( content.indexOf( text ) != -1 ) {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// и мы в MSIE</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> ( <font color="#0000ff">document</font>.body.createTextRange ) {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Создадим объект TextRange</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> rng = <font color="#0000ff">document</font>.body.createTextRange();<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Свернем его до root</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng.moveToElementText( root );<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Найдем текст и свернем диапазон до него</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> ( rng.findText( text ) )<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// Заменим текстовый фрагмент на span с синим фоном</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng.pasteHTML( <font color="#A31515">'&lt;span style=&quot;background:blue;&quot;&gt;'</font> + text + <font color="#A31515">'&lt;/span&gt;'</font> );<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;} <font color="#0000ff">else</font> <br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(<font color="#A31515">'Вероятно, у вас не IE (поздравляем!), смотрите реализацию Range выше'</font>);<br/>
 &nbsp;&nbsp;} <font color="#0000ff">else</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;alert(<font color="#A31515">'Совпадений не найдено'</font>);<br/>
 }</font></code><br/>
<br/>
<a href="http://2007.fastcoder.ru/articles/?aid=609#demo5">Пример в действии</a>.<br/>
<br/>
С остальными свойствами и методами поэкспериментируйте сами.<br/>
<br/>
<h2>2. Selection</h2><br/>
 Всем знакомо выделение элементов на странице, когда, зажав левую кнопку мыши и передвигая курсор, мы выделяем нужный фрагмент. Или зажимаем Shift и жмем на стрелочки клавиатуры. Или еще как-то, неважно. В данной части статьи мы кроссбраузерно научимся решать две задачи: получать пользовательское выделение и устанавливать собственное.<br/>
<br/>
<h3>2.1. Получаем пользовательское выделение</h3><br/>
 Эту задачу мы уже решали в самом начале статьи <a href="#demo1">в примере с миксом</a>. Теперь рассмотрим код:<br/>
<br/>
<code><font color="black">$selection = {<br/>
 &nbsp;&nbsp;getText : <font color="#0000ff">function</font>() {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> txt = <font color="#A31515">''</font>;<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> (txt = window.getSelection) <font color="#008000">// Not IE, используем метод getSelection</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;txt = window.getSelection().toString();<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">else</font> <font color="#008000">// IE, используем объект selection</font><br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;txt = <font color="#0000ff">document</font>.selection.createRange().text;<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> txt;<br/>
 &nbsp;&nbsp;}<br/>
 }</font></code><br/>
<br/>
Все браузеры, кроме Internet Explorer поддерживают метод <strong>getSelection</strong> в контексте window, который возвращает объект, схожий с <a href="#range">рассмотренным ранее Range</a>. У этого объекта есть точка начала выделения (anchor) и фокусная точка окончания (focus). Точки могут совпадать. Рассмотрим свойства и методы Selection-объекта: <img src="https://habrastorage.org/getpro/habr/post_images/d86/306/e47/d86306e474a89377a537d48d365846da.gif" width="16" height="16" alt="Mozilla Firefox supported"/><img src="https://habrastorage.org/getpro/habr/post_images/576/500/807/57650080760b39c44fb782b7193c9005.gif" width="16" height="16" alt="Chrome supported"/><img src="https://habrastorage.org/getpro/habr/post_images/b2d/f7a/89d/b2df7a89dcf08d3344528b3282d5ff71.gif" width="16" height="16" alt="Opera supported"/><img src="https://habrastorage.org/getpro/habr/post_images/32b/3fa/755/32b3fa7553da67019db6d386f590713e.gif" width="16" height="16" alt="Safari supported"/><br/>
 <ul>
<li>Свойство <strong>anchorNode</strong> вернет контейнер, в котором начинается выделение. Замечу, что началом выделения считается та граница, от которой вы начали выделение. То есть, если вы выделяете справа налево, то началом будет именно правая граница. Это правило работает везде, кроме браузера Opera, в котором anchorNode вернет ссылку на узел левого края выделения.</li>
<li>Свойство <strong>anchorOffset</strong> вернет смещение для начала выделения в пределах контейнера anchorNode.</li>
<li>Свойства <strong>focusNode</strong> и <strong>focusOffset</strong> работают аналогично для фокусных точек, то есть точек окончания выделения. Opera и здесь отличилась, возвращает вместо фокусной точки узел правого края выделения.</li>
<li>Свойство <strong>rangeCount</strong> возвращает число Range-объектов, которые входят в полученное выделение. Это свойство полезно при использовании метода addRange.</li>
</ul><br/>
 <ul>
<li>Метод <strong>getRangeAt</strong> принимает в качестве аргумента индекс Range-объекта и возвращает сам объект. Если rangeCount == 1, то работать будет только <strong>getRangeAt(0)</strong>. Таким образом, мы можем получить Range-объект, полностью соответствующий текущему выделению.</li>
<li>Метод <strong>collapse</strong> сворачивает выделение в точку (каретку). Методу можно передать в качестве первого аргумента узел, в который нужно поместить каретку.</li>
<li>Метод <strong>extend</strong> принимает в качестве аргументов ссылку на контейнер и смещение (parentNode, offset), и перемещает фокусную точку в это положение.</li>
<li>Метод <strong>collapseToStart</strong> (<strong>collapseToEnd</strong>) перемещает фокусную (начальную) границу к начальной (фокусной), тем самым сворачивая выделение в каретку.</li>
<li>Метод <strong>selectAllChildren</strong> принимает в качестве единственного аргумента ссылку на узел и добавляет всех его потомков в выделение.</li>
<li>Метод <strong>addRange</strong> принимает в качестве аргумента Range-объект и добавляет его в выделение. Таким образом можно увеличить количество Range-объектов, число которых нам подскажет свойство rangeCount.</li>
<li>Метод <strong>removeRange</strong> (<strong>removeAllRanges</strong>) удаляет переданный (все) Range-объект из выделения.</li>
<li>Метод <strong>toString</strong> вернет текстовое содержимое выделения.</li>
</ul><br/>
 Internet Explorer предоставляет собственный интерфейс взаимодействия с выделениями &mdash; объект <strong>selection</strong> в контексте document. Для работы с этим объектом используются следующие методы <img src="https://habrastorage.org/getpro/habr/post_images/58e/0d1/ed1/58e0d1ed15240e9c2acf53d14c3214c2.gif" width="16" height="16" alt="Internet Explorer supported"/><br/>
 <ul>
<li>Метод <strong>clear</strong> убирает выделение вместе с содержимым.</li>
<li>Метод createRange (ВАЖНО! Не путать с DOM-методом createRange для создания Range-объектов!) создает из содержимого выделения TextRange-объект.</li>
<li>Метод <strong>empty</strong> убирает выделение, но оставляет содержимое.</li>
</ul><br/>
 Надеюсь, теперь, после знакомства с обеими реализациями выделений, код выше стал более понятен.<br/>
<br/>
<h3>2.1. Установка собственного выделения</h3><br/>
 Допустим, вам хочется, чтобы какой-то текстовый фрагмент на странице был выделен, как пользовательское выделение. Это нужно при клиентской реализации поиска по странице и некоторых других задач. Проще всего решить эту задачу следующим образом:<br/>
 <ol>
<li>Создать Range-объект (TextRange для IE).</li>
<li>Перевести полученный объект в выделение.</li>
</ol><br/>
 Смотрим реализацию:<br/>
<br/>
<code><font color="black"><font color="#0000ff">&lt;</font><font color="#800000">div</font> <font color="#ff0000">id</font><font color="#0000ff">=&quot;ex5&quot;</font><font color="#0000ff">&gt;</font><br/>
 &nbsp;&nbsp;Снова будем выделять <font color="#0000ff">&lt;</font><font color="#800000">span</font><font color="#0000ff">&gt;</font>бабулю<font color="#0000ff">&lt;/</font><font color="#800000">span</font><font color="#0000ff">&gt;</font>, на этот раз без поиска.<br/>
 <font color="#0000ff">&lt;/</font><font color="#800000">div</font><font color="#0000ff">&gt;</font></font></code><br/>
<br/>
<code><font color="black">$selection.set = <font color="#0000ff">function</font>() {<br/>
 &nbsp;&nbsp;<font color="#0000ff">var</font> target = <font color="#0000ff">document</font>.getElementById(<font color="#A31515">'ex5'</font>).getElementsByTagName(<font color="#A31515">'span'</font>)[0];<br/>
 &nbsp;&nbsp;<font color="#0000ff">var</font> rng, sel;<br/>
 &nbsp;&nbsp;<font color="#0000ff">if</font> ( <font color="#0000ff">document</font>.createRange ) {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;rng = <font color="#0000ff">document</font>.createRange();<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;rng.selectNode( target )<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;sel = window.getSelection();<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;sel.removeAllRanges();<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;sel.addRange( rng );<br/>
 &nbsp;&nbsp;} <font color="#0000ff">else</font> {<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> rng = <font color="#0000ff">document</font>.body.createTextRange();<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;rng.moveToElementText( target );<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;rng.select();<br/>
 &nbsp;&nbsp;}<br/>
 }</font></code><br/>
<br/>
<a href="http://2007.fastcoder.ru/articles/?aid=609#demo6">Пример в действии</a>.<br/>
<br/>
<h2>3. Послесловие</h2><br/>
 Осмысливая в процессе написания статьи предоставляемое API, возникла идея создать небольшую библиотеку, которая научит IE DOM-реализации Range и Selection. Возможно, она даже существует, тогда автор вам будет благодарен за ссылку и экономию собственного времени.<br/>
<br/>
Описание API не претендует на полноту и точность перевода, но автору этого вполне достаточно для комфортной JavaScript-разработки. С оригиналами на английском вы можете ознакомиться по ссылкам ниже.<br/>
<br/>
Кросспост статьи <a href="http://2007.fastcoder.ru/articles/?aid=609">Range, TextRange и Selection</a> с <a href="http://2007.fastcoder.ru/">fastcoder.org</a>.<br/>
<br/>
<h2>4. Ссылки</h2><ul>
<li><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html">Спецификация Document Object Model Range на сайте W3C</a></li>
<li><a href="https://developer.mozilla.org/En/DOM/Selection">Описание реализации выделений на developer.mozilla.org</a></li>
<li><a href="https://developer.mozilla.org/En/DOM/Range">Описание реализации Range на developer.mozilla.org</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/ms535872.aspx">Описание объекта TextRange в msdn</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/ms536401(VS.85).aspx">Метод createTextRange в msdn</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/ms535869(VS.85).aspx">Объект selection в msdn</a></li>
</ul></div>
    
    <div class="post__tags">
  <ul class="tags icon_tag">
      <li ><a href="https://habrahabr.ru/search/?q=%5BJavaScript%5D&target_type=posts" rel="tag">JavaScript</a>, </li>
      <li ><a href="https://habrahabr.ru/search/?q=%5BRange%5D&target_type=posts" rel="tag">Range</a>, </li>
      <li ><a href="https://habrahabr.ru/search/?q=%5BTextRange%5D&target_type=posts" rel="tag">TextRange</a>, </li>
      <li ><a href="https://habrahabr.ru/search/?q=%5BSelection%5D&target_type=posts" rel="tag">Selection</a></li>
  </ul>
</div>
  </div>
</div>


        </div>
      </div>

      <div class="sidebar_right sidebar_content-area">
            <div class="xyz_wrapper is_visible">
    <div class="xyz_wrapper_inner" id="xyz_wrapper" style="width:100%;min-height: 250px;">
      <span class="xyz_wrapper_text" id="xyz_text">Реклама помогает поддерживать и&nbsp;развивать наши сервисы<br/><br/><a href="/adblock/" class="xyz_wrapper_button" target="_blank">Подробнее</a></span>
      <!--  AdRiver code START. Type:AjaxJS Site: habrahabr BN:1 -->
      <div id="adriver_banner_1096808718" style="background:#fff;width: 100%;text-align:center;"></div>
      <script type="text/javascript">
        var keyword = '';
        var custom = [];
        custom[7] = ar_duo1;

        if (typeof crtg_content !== 'undefined' && crtg_content) { keyword = crtg_content; }
         custom[1] = 'h_javascript';  custom[2] = 'f_develop'; 

        if ( typeof(adriver) !== 'undefined'){
          hidePlaceholder();
          new adriver("adriver_banner_1096808718", {sid:176776, bt:52, bn:1, custom: custom, keyword: keyword});
        }

        function hidePlaceholder(){
          document.getElementById('xyz_wrapper').style.background = "white";
          document.getElementById('xyz_text').style.display = "none";
        }
      </script>
      <!--  AdRiver code END  -->
    </div>
    <a href="https://special.habrahabr.ru/advertising/" class="firskill__label">Реклама</a>
  </div>

          

  <div class="sidebar-block sidebar-block_top-hubs js-tophubs">
    <h2 class="sidebar-block__title">Хабы</h2>
    <div class="sidebar-block__content">
      <ul class="content-list top-hubs">
          <li class="content-list__item top-hubs__item">
            <a href="https://habrahabr.ru/hub/webdev/" class="content-list__item-link top-hubs__item-title" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'Разработка веб-сайтов'); }">Разработка веб-сайтов</a>
          </li>
          <li class="content-list__item top-hubs__item">
            <a href="https://habrahabr.ru/hub/programming/" class="content-list__item-link top-hubs__item-title" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'Программирование'); }">Программирование</a>
          </li>
          <li class="content-list__item top-hubs__item">
            <a href="https://habrahabr.ru/hub/itstandarts/" class="content-list__item-link top-hubs__item-title" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'IT-стандарты'); }">IT-стандарты</a>
          </li>
          <li class="content-list__item top-hubs__item">
            <a href="https://habrahabr.ru/hub/infosecurity/" class="content-list__item-link top-hubs__item-title" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'Информационная безопасность'); }">Информационная безопасность</a>
          </li>
          <li class="content-list__item top-hubs__item">
            <a href="https://habrahabr.ru/hub/csharp/" class="content-list__item-link top-hubs__item-title" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'C#'); }">C#</a>
          </li>
          <li class="content-list__item top-hubs__item">
            <a href="https://habrahabr.ru/hub/php/" class="content-list__item-link top-hubs__item-title" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'PHP'); }">PHP</a>
          </li>
          <li class="content-list__item top-hubs__item">
            <a href="https://habrahabr.ru/hub/open_source/" class="content-list__item-link top-hubs__item-title" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'Open source'); }">Open source</a>
          </li>
          <li class="content-list__item top-hubs__item">
            <a href="https://habrahabr.ru/hub/arvrdev/" class="content-list__item-link top-hubs__item-title" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'Разработка под AR и VR'); }">Разработка под AR и VR</a>
          </li>
          <li class="content-list__item top-hubs__item">
            <a href="https://habrahabr.ru/hub/java/" class="content-list__item-link top-hubs__item-title" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'Java'); }">Java</a>
          </li>
          <li class="content-list__item top-hubs__item">
            <a href="https://habrahabr.ru/hub/ios_dev/" class="content-list__item-link top-hubs__item-title" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'Разработка под iOS'); }">Разработка под iOS</a>
          </li>
      </ul>
    </div>
    <div class="sidebar-block__footer">
      <a href="/flows/develop/hubs/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'hubs', 'all_hubs'); }">Все хабы</a>
    </div>
  </div>

            <div class="js-ad_sticky"><div class="xyz_wrapper">
  <div class="xyz_wrapper_inner">
    <span class="xyz_wrapper_text">Реклама помогает поддерживать и&nbsp;развивать наши сервисы<br/><br/><a href="/adblock/" class="xyz_wrapper_button" target="_blank">Подробнее</a></span>

    <!-- Yandex.RTB R-A-149298-19 -->
    <div id="yandex_rtb_R-A-149298-19" style="background: #fff;"></div>
    <script type="text/javascript">
        (function(w, d, n, s, t) {
            w[n] = w[n] || [];
            w[n].push(function() {
                Ya.Context.AdvManager.render({
                    blockId: "R-A-149298-19",
                    renderTo: "yandex_rtb_R-A-149298-19",
                    async: true
                });
            });
            t = d.getElementsByTagName("script")[0];
            s = d.createElement("script");
            s.type = "text/javascript";
            s.src = "//an.yandex.ru/system/context.js";
            s.async = true;
            t.parentNode.insertBefore(s, t);
        })(this, this.document, "yandexContextAsyncCallbacks");
    </script>
  </div>
  <a href="https://special.habrahabr.ru/advertising/" class="firskill__label">Реклама</a>
</div>
</div>
      </div>
    </div>

    <div class="column-wrapper">
      <div class="content_left indented">
        <div class="post-additionals">
            <div class="infopanel_wrapper js-user_33108">
    <ul class="postinfo-panel postinfo-panel_post" id="infopanel_post_55922">

          <li class="postinfo-panel__item">
            <div class="voting-wjt voting-wjt_infopanel js-voting  ">
                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи.">
                  <span>&uarr;</span>
                </button>

              <div class="voting-wjt__counter voting-wjt__counter_positive  js-mark">
                  <span class="voting-wjt__counter-score js-score" title="Общий рейтинг 96: &uarr;96 и &darr;0">+96</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи.">
                  <span>&darr;</span>
                </button>

            </div>
          </li>

      <li class="postinfo-panel__item">
        <div class="views-count_post" title="Просмотры публикации">57,1k</div>
      </li>

      <li class="postinfo-panel__item">
        <div class="favorite-wjt favorite">
            <button type="button" disabled class="favorite-wjt__button favorite-wjt__button_disabled" onclick="return false;" title="Только зарегистрированные пользователи могут добавлять публикации в избранное">
              <span>Добавить в избранное</span>
            </button>
          <span class="favorite-wjt__counter js-favs_count" title="Количество пользователей, добавивших публикацию в избранное">337</span>
        </div>
      </li>




      <li class="postinfo-panel__item postinfo-panel__item_align-right">
          <!-- шеринг в соцсети -->
          <ul class="post-share">
            <li class="post-share__item">
              <a href="https://twitter.com/intent/tweet?text=Range%2C+TextRange+%D0%B8+Selection+https://habr.ru/p/55922/+via+%40habrahabr+%23habr" class="post-share__item-link twitter" onclick="window.open(this.href, 'Опубликовать ссылку  в Twitter', 'width=800,height=300,resizable=yes,toolbar=0,status=0'); return false" title="Опубликовать ссылку в Twitter"></a>
            </li>
            <li class="post-share__item">
              <a href="https://vk.com/share.php?url=https://habrahabr.ru/post/55922/" class="post-share__item-link vkontakte" title="Опубликовать ссылку во ВКонтакте" onclick="window.open(this.href, 'Опубликовать ссылку во Вконтакте', 'width=800,height=300,toolbar=0,status=0'); return false"></a>
            </li>
            <li class="post-share__item">
              <a href="https://www.facebook.com/sharer/sharer.php?u=https://habrahabr.ru/post/55922/" class="post-share__item-link facebook" title="Опубликовать ссылку в Facebook" onclick="window.open(this.href, 'Опубликовать ссылку в Facebook', 'width=640,height=436,toolbar=0,status=0'); return false"></a>
            </li>
            <li class="post-share__item">
              <a href="https://getpocket.com/edit?url=https://habrahabr.ru/post/55922/&title=Range, TextRange и Selection" target="_blank" class="post-share__item-link pocket" title="Добавить ссылку в Pocket"></a>
            </li>
          </ul>

      </li>
    </ul>
  </div>

              <form action="/conversations/bur/" method="GET" class="form form_admin-causes hidden" id="admin_causes">
    <input type="hidden" name="moderation" value="55922">
    <fieldset class="form__fieldset form__fieldset_admin-causes">
      <legend class="form__legend">Выберите рекомендации для отправки автору:</legend>
      <label class="form__label form__label_block">
        <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="1">
        <span class="form__label-text">Указан только блог</span>
      </label>
      <label class="form__label form__label_block">
        <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="2">
        <span class="form__label-text">Орфографические ошибки</span>
      </label>
      <label class="form__label form__label_block">
        <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="3">
        <span class="form__label-text">Пунктуационные ошибки</span>
      </label>
      <label class="form__label form__label_block">
        <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="4">
        <span class="form__label-text">Отступы</span>
      </label>
      <label class="form__label form__label_block">
        <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="5">
        <span class="form__label-text">Текст-простыня</span>
      </label>
      <label class="form__label form__label_block">
        <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="6">
        <span class="form__label-text">Короткие предложения</span>
      </label>
      <label class="form__label form__label_block">
        <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="7">
        <span class="form__label-text">Смайлики</span>
      </label>
      <label class="form__label form__label_block">
        <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="8">
        <span class="form__label-text">Много форматирования</span>
      </label>
      <label class="form__label form__label_block">
        <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="9">
        <span class="form__label-text">Картинки</span>
      </label>
      <label class="form__label form__label_block">
        <input type="checkbox" class="form__input form__input_checkbox" name="id[]"" value="10">
        <span class="form__label-text">Ссылки</span>
      </label>
    </fieldset>

    <button type="submit" class="btn btn_medium btn_grey">Отправить</button>
  </form>

              

  <div class="author-info ">
    <a href="/users/bur" class="author-info__image" onclick="if (typeof ga === 'function') { ga('send', 'event', 'author_info_bottom', 'profile', 'bur');}">
        <span class="user-pic_default user-pic_default_47 user-pic_blue"></span>
    </a>

    <div class="author-info__desc js-user_33108">
      <div class="author-info__username">
          <a href="/users/bur" class="author-info__name" onclick="if (typeof ga === 'function') { ga('send', 'event', 'author_info_bottom', 'profile', 'bur');}">Александр</a>
        <a href="/users/bur" class="author-info__nickname" onclick="if (typeof ga === 'function') { ga('send', 'event', 'author_info_bottom', 'profile', 'bur');}">@bur</a>

        <div class="karma__widjet voting-wjt voting-wjt_small js-karma  " title="Карма пользователя">


          <div class="voting-wjt__counter js-karma-mark voting-wjt__counter_positive " title="112 голосов">
            <div class="voting-wjt__label">карма</div>
            <div class="voting-wjt__counter-score js-karma_num">104,0</div>
          </div>

        </div>

        <div class="user-rating" title="Рейтинг пользователя">
          <span class="user-rating__label">рейтинг</span>
          <span class="user-rating__value">0,0</span>
        </div>

      </div>


    </div>
  </div>

        </div>
          

    <div class="similar-posts">
      <h2 class="similar-posts__title">Похожие публикации</h2>

      <ul class="content-list content-list_posts">
          <li class="content-list__item">
            <div class="post-preview">
              <div class="post-preview__rating">+14</div>
              <div class="post-preview__desc">
                <a class="post-preview__link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'similar_posts', 'common'); }" href="/post/319476/">Чистый javascript.Переменные</a>
                <span class="post-preview__attrs inline-list inline-list_attrs">
                  <span class="inline-list__item views-count">16,3k</span>
                  <span class="inline-list__item favorites-count">136</span>
                  <span class="inline-list__item comments-count">36</span>
                </span>
              </div>
            </div>
          </li>
          <li class="content-list__item">
            <div class="post-preview">
              <div class="post-preview__rating">+4</div>
              <div class="post-preview__desc">
                <a class="post-preview__link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'similar_posts', 'common'); }" href="/post/319472/">Чистый javascript.Введение</a>
                <span class="post-preview__attrs inline-list inline-list_attrs">
                  <span class="inline-list__item views-count">12,6k</span>
                  <span class="inline-list__item favorites-count">150</span>
                  <span class="inline-list__item comments-count">7</span>
                </span>
              </div>
            </div>
          </li>
          <li class="content-list__item">
            <div class="post-preview">
              <div class="post-preview__rating">+21</div>
              <div class="post-preview__desc">
                <a class="post-preview__link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'similar_posts', 'common'); }" href="/post/13529/">FWC: SmartSelect — тулкит для работы с компонентами форм типа select, combobox и т.д.</a>
                <span class="post-preview__attrs inline-list inline-list_attrs">
                  <span class="inline-list__item views-count">2,5k</span>
                  <span class="inline-list__item favorites-count">35</span>
                  <span class="inline-list__item comments-count">85</span>
                </span>
              </div>
            </div>
          </li>
      </ul>
    </div>


            <div class="html_banner_wrap ">
      <!--  AdRiver code START. Type:AjaxJS Site: habrahabr PZ: 0 BN: 13 -->
      <div class="html_banner" id="adriver_banner_1109509440"></div>
      <script type="text/javascript">
        function loadAdriverBanner(){
          var keyword = '';
          var custom = [];
          custom[7] = ar_duo1;

          if (typeof crtg_content !== 'undefined' && crtg_content) { keyword = crtg_content; }
           custom[1] = 'h_javascript';  custom[2] = 'f_develop'; 

          if ( typeof(adriver) !== 'undefined'){
            new adriver("adriver_banner_1109509440", {sid:176776, bt:52, bn:13, custom: custom, keyword: keyword})
          }
        }
      </script>
    </div>

        

  <div class="similar-posts similar-posts_full">
    <h2 class="similar-posts__title_wrap">
      <span class="similar-posts__title">Самое читаемое</span>
        <span class="similar-posts__flow">
          <a href="https://habrahabr.ru/flows/develop/" class="similar-posts__flow-link">Разработка</a>
        </span>
    </h2>
    <div class="live-broadcast__tabs tabs" id="broadcast_tabs_posts">

      <ul class="tabs__menu tabs__menu_posts menu menu_inline">
        <li class="menu__item"><a href="#broadcast_posts_now" class="menu__item-tab">Сейчас</a></li>
        <li class="menu__item"><a href="#broadcast_posts_today" class="menu__item-tab">Сутки</a></li>
        <li class="menu__item"><a href="#broadcast_posts_week" class="menu__item-tab">Неделя</a></li>
        <li class="menu__item"><a href="#broadcast_posts_month" class="menu__item-tab">Месяц</a></li>
      </ul>

        <div class="tabs__content tabs__content_reading" id="broadcast_posts_now">
            <ul class="content-list content-list_posts content-list_most-reading">
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+80</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320612/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Ещё немного про телефоны Xiaomi и борьбу с ними</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">46k</span>
                        <span class="inline-list__item favorites-count">317</span>
                        <span class="inline-list__item comments-count">93</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+11</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/316216/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Будут ли роботы стоять в пробках?</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">3k</span>
                        <span class="inline-list__item favorites-count">17</span>
                        <span class="inline-list__item comments-count">15</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+13</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320830/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Однострочный калькулятор, искусство или порок?</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">11,1k</span>
                        <span class="inline-list__item favorites-count">36</span>
                        <span class="inline-list__item comments-count">39</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+81</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/company/badoo/blog/320558/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">33 способа ускорить ваш фронтенд в 2017 году</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">23,4k</span>
                        <span class="inline-list__item favorites-count">618</span>
                        <span class="inline-list__item comments-count">25</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+10</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320664/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Google ReCAPTCHA Invisible или долой дорожные знаки и витрины магазинов</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">11k</span>
                        <span class="inline-list__item favorites-count">41</span>
                        <span class="inline-list__item comments-count">43</span>
                      </span>
                    </div>
                  </div>
                </li>
            </ul>
        </div>
        <div class="tabs__content tabs__content_reading" id="broadcast_posts_today">
            <ul class="content-list content-list_posts content-list_most-reading">
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+21</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/company/it-grad/blog/319618/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">D-Wave Systems продали свой первый 2000-кубитный квантовый компьютер</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">14,4k</span>
                        <span class="inline-list__item favorites-count">30</span>
                        <span class="inline-list__item comments-count">22</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+13</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320830/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Однострочный калькулятор, искусство или порок?</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">11,1k</span>
                        <span class="inline-list__item favorites-count">36</span>
                        <span class="inline-list__item comments-count">39</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+10</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320664/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Google ReCAPTCHA Invisible или долой дорожные знаки и витрины магазинов</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">11k</span>
                        <span class="inline-list__item favorites-count">41</span>
                        <span class="inline-list__item comments-count">43</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+80</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320612/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Ещё немного про телефоны Xiaomi и борьбу с ними</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">46k</span>
                        <span class="inline-list__item favorites-count">317</span>
                        <span class="inline-list__item comments-count">93</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+31</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320694/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Hack.me: Ещё одна площадка для оттачивания навыков в области ИБ</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">12,9k</span>
                        <span class="inline-list__item favorites-count">252</span>
                        <span class="inline-list__item comments-count">8</span>
                      </span>
                    </div>
                  </div>
                </li>
            </ul>
        </div>
        <div class="tabs__content tabs__content_reading" id="broadcast_posts_week">
            <ul class="content-list content-list_posts content-list_most-reading">
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+80</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320612/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Ещё немного про телефоны Xiaomi и борьбу с ними</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">46k</span>
                        <span class="inline-list__item favorites-count">317</span>
                        <span class="inline-list__item comments-count">93</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+59</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320580/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Интервью с ддосером или на чем зарабатывают вандалы</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">31,5k</span>
                        <span class="inline-list__item favorites-count">132</span>
                        <span class="inline-list__item comments-count">55</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+61</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320700/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Подмена провайдером DNS-запросов</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">30,3k</span>
                        <span class="inline-list__item favorites-count">112</span>
                        <span class="inline-list__item comments-count">102</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+60</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320602/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Борьба с читерами в онлайн-играх: 22 «нужно» и «нельзя»</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">26,9k</span>
                        <span class="inline-list__item favorites-count">148</span>
                        <span class="inline-list__item comments-count">96</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+60</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320572/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">На 100% правильный способ проверки адресов электронной почты</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">24,8k</span>
                        <span class="inline-list__item favorites-count">182</span>
                        <span class="inline-list__item comments-count">96</span>
                      </span>
                    </div>
                  </div>
                </li>
            </ul>
        </div>
        <div class="tabs__content tabs__content_reading" id="broadcast_posts_month">
            <ul class="content-list content-list_posts content-list_most-reading">
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+96</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/318916/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Писать веб-сайты на ассемблере полезно и приятно</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">61,7k</span>
                        <span class="inline-list__item favorites-count">270</span>
                        <span class="inline-list__item comments-count">428</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+107</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/318894/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Как проектируют ненастоящие программисты</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">56k</span>
                        <span class="inline-list__item favorites-count">160</span>
                        <span class="inline-list__item comments-count">264</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+75</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/319360/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Уязвимость Viber, позволяющая прослушивать чужой разговор</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">50,4k</span>
                        <span class="inline-list__item favorites-count">58</span>
                        <span class="inline-list__item comments-count">33</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+80</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/320612/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">Ещё немного про телефоны Xiaomi и борьбу с ними</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">46k</span>
                        <span class="inline-list__item favorites-count">317</span>
                        <span class="inline-list__item comments-count">93</span>
                      </span>
                    </div>
                  </div>
                </li>
                <li class="content-list__item">
                  <div class="post-preview">
                    <div class="post-preview__rating">+175</div>
                    <div class="post-preview__desc">
                      <a href="https://habrahabr.ru/post/319774/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'post'); }" class="post-preview__link">IDEA пора закапывать?</a>
                      <span class="post-preview__attrs inline-list inline-list_attrs">
                        <span class="inline-list__item views-count">45,6k</span>
                        <span class="inline-list__item favorites-count">80</span>
                        <span class="inline-list__item comments-count">519</span>
                      </span>
                    </div>
                  </div>
                </li>
            </ul>
        </div>
    </div>
  </div>




      </div>
    </div>
  </div>

  <div class="column-wrapper column-wrapper_comments">
    <div class="content_left">
          <div class="comments_list " id="comments">
    <h2 class="title ">
      Комментарии (<span id="comments_count">28</span>)
      
    </h2>

    

    

    <ul id="comments-list">
      
  <li class="comment_item" id="comment_1499266" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1499266">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="Astashov_Anton">
            <a href="https://habrahabr.ru/users/Astashov_Anton/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/Astashov_Anton/" class="comment-item__username">Astashov_Anton</a>
          </span>

          <time class="comment-item__time_published">
            30 марта 2009 в 18:35
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1499266" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1499266" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark voting-wjt__counter_positive ">
                <span class="voting-wjt__counter-score js-score" title="Всего 4: &uarr;3 и &darr;1">+2</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Ух, как здорово! Спасибо!
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1499266">
      
  <li class="comment_item" id="comment_1499277" >
    
    <span class="parent_id" data-parent_id="1499266"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item is_topic_starter " rel="1499277">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="bur">
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__username">bur</a>
          </span>

          <time class="comment-item__time_published">
            30 марта 2009 в 18:37
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1499277" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1499277" data-parent_id="1499266" title="Показать ветку комментариев"></span>
              <a href="#comment_1499266" class="icon_comment-parent js-comment_parent" data-id="1499277" data-parent_id="1499266" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1499277" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark voting-wjt__counter_positive ">
                <span class="voting-wjt__counter-score js-score" title="Всего 1: &uarr;1 и &darr;0">+1</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Вэлкам!<br/>
Размочим нулевое количество комментов :-)<br/>
Хотя, к справочным данным особо ничего в догонку не напишешь…
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1499277">
      
  <li class="comment_item" id="comment_1499342" >
    
    <span class="parent_id" data-parent_id="1499277"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1499342">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="Tagire">
            <a href="https://habrahabr.ru/users/Tagire/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/Tagire/" class="comment-item__username">Tagire</a>
          </span>

          <time class="comment-item__time_published">
            30 марта 2009 в 18:52
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1499342" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1499342" data-parent_id="1499277" title="Показать ветку комментариев"></span>
              <a href="#comment_1499277" class="icon_comment-parent js-comment_parent" data-id="1499342" data-parent_id="1499277" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1499342" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark voting-wjt__counter_positive ">
                <span class="voting-wjt__counter-score js-score" title="Всего 2: &uarr;2 и &darr;0">+2</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Ну можно начать ругать эксплорер за собственые реализации.
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1499342">
      
  <li class="comment_item" id="comment_1499363" >
    
    <span class="parent_id" data-parent_id="1499342"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item is_topic_starter " rel="1499363">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="bur">
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__username">bur</a>
          </span>

          <time class="comment-item__time_published">
            30 марта 2009 в 19:00
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1499363" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1499363" data-parent_id="1499342" title="Показать ветку комментариев"></span>
              <a href="#comment_1499342" class="icon_comment-parent js-comment_parent" data-id="1499363" data-parent_id="1499342" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1499363" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Тесты в stable-версии ИЕ8 показали, что ребята из Силиконовой долины перенесли реализацию TextRange в свой флагман. Так что статья будет еще долгое время актуальной.<br/>
<br/>
DOM-реализации Range автор там не нашел. Может плохо искал?
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1499363">
      
  <li class="comment_item" id="comment_1499386" >
    
    <span class="parent_id" data-parent_id="1499363"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1499386">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="Tagire">
            <a href="https://habrahabr.ru/users/Tagire/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/Tagire/" class="comment-item__username">Tagire</a>
          </span>

          <time class="comment-item__time_published">
            30 марта 2009 в 19:05
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1499386" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1499386" data-parent_id="1499363" title="Показать ветку комментариев"></span>
              <a href="#comment_1499363" class="icon_comment-parent js-comment_parent" data-id="1499386" data-parent_id="1499363" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1499386" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Ну поэтому я и говорил, что можно начать ругать)<br/>
Кстати, майкрософт можно приводить в пример велосипедистам.
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1499386">
      
      
    </ul>

  </li>

      
    </ul>

  </li>

  <li class="comment_item" id="comment_1499543" >
    
    <span class="parent_id" data-parent_id="1499342"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1499543">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="no_smoking">
            <a href="https://habrahabr.ru/users/no_smoking/" class="comment-item__avatar">
                <img src="//habrastorage.org/getpro/habr/avatars/7fc/6b9/2f0/7fc6b92f091984ddad98ef411e39b274_small.jpg" alt="" class="comment-item__avatar-img"/>
            </a>
            <a href="https://habrahabr.ru/users/no_smoking/" class="comment-item__username">no_smoking</a>
          </span>

          <time class="comment-item__time_published">
            30 марта 2009 в 20:12
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1499543" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1499543" data-parent_id="1499342" title="Показать ветку комментариев"></span>
              <a href="#comment_1499342" class="icon_comment-parent js-comment_parent" data-id="1499543" data-parent_id="1499342" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1499543" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Меду так прочим такой обьект появился вначале в ие а потом уже и у других браузеров только почемуто с совершенно другим интерфейсом.
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1499543">
      
      
    </ul>

  </li>

  <li class="comment_item" id="comment_1501778" >
    
    <span class="parent_id" data-parent_id="1499342"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1501778">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="galexey">
            <a href="https://habrahabr.ru/users/galexey/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/galexey/" class="comment-item__username">galexey</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 16:20
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1501778" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1501778" data-parent_id="1499342" title="Показать ветку комментариев"></span>
              <a href="#comment_1499342" class="icon_comment-parent js-comment_parent" data-id="1501778" data-parent_id="1499342" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1501778" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          В IE реализация работы с выделениями лучше.<br/>
Легко посчитать размеры в пикселях занятые под выделение.<br/>
Одинаковая логика работы с выделениями что внутри input-ах с textarea-ми, что вне их.<br/>
Единственный минус тот же что и в innerHTML — не работает правильно вставка содержимого внутри таблиц, списков и т.п. и возвращает творчески переосмысленный html код выделенного.
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1501778">
      
  <li class="comment_item" id="comment_1501880" >
    
    <span class="parent_id" data-parent_id="1501778"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item is_topic_starter " rel="1501880">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="bur">
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__username">bur</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 16:46
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1501880" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1501880" data-parent_id="1501778" title="Показать ветку комментариев"></span>
              <a href="#comment_1501778" class="icon_comment-parent js-comment_parent" data-id="1501880" data-parent_id="1501778" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1501880" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Для решения каких задач вам нужно знать число пикселей под выделением? :-)<br/>
<br/>
В целом, DOM-реализация Range мне нравится тем, что граничные точки теснее привязаны к DOM. Это удобнее, чем манипулировать текстовыми смещениями.<br/>
<br/>
Хотя вопрос удобства той или иной реализации можно решить только на примере конкретных практических задач. Абстрактные рассуждения, имхо, не уместны.
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1501880">
      
  <li class="comment_item" id="comment_1502007" >
    
    <span class="parent_id" data-parent_id="1501880"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1502007">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="galexey">
            <a href="https://habrahabr.ru/users/galexey/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/galexey/" class="comment-item__username">galexey</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 17:16
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1502007" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1502007" data-parent_id="1501880" title="Показать ветку комментариев"></span>
              <a href="#comment_1501880" class="icon_comment-parent js-comment_parent" data-id="1502007" data-parent_id="1501880" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1502007" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          реальная задача, разбить длинное (в пикселях) слово, чоб не уползало за экран.<br/>
Это вам кажется что удобно, привязка текста к DOM элементам. Это две независящие друг от друга стихии… вот удалите вы DOM элемент в котором стартует выделение и что? придется сохраненный ранее бекап выделения придется переосмысливать.
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1502007">
      
  <li class="comment_item" id="comment_1502039" >
    
    <span class="parent_id" data-parent_id="1502007"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item is_topic_starter " rel="1502039">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="bur">
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__username">bur</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 17:24
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1502039" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1502039" data-parent_id="1502007" title="Показать ветку комментариев"></span>
              <a href="#comment_1502007" class="icon_comment-parent js-comment_parent" data-id="1502039" data-parent_id="1502007" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1502039" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Задачу, которую вы привели в пример, не стоит решать через Range (если я конечно правильно понял суть):<br/>
<a href="http://fastcoder.org/articles/?aid=183">fastcoder.org/articles/?aid=183</a><br/>
<br/>
С удалением DOM-элементов, если этим занимается скрипт, а не пользователь, конечно, беда. Придется проверять не является ли элемент контейнером анкора/фокуса и переносить граничную точку в родительский узел. Из комментов ниже я понял, что в ИЕ для этого букмарки сделали.
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1502039">
      
      
    </ul>

  </li>

      
    </ul>

  </li>

      
    </ul>

  </li>

      
    </ul>

  </li>

      
    </ul>

  </li>

      
    </ul>

  </li>

      
    </ul>

  </li>

  <li class="comment_item" id="comment_1499271" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1499271">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="l2k">
            <a href="https://habrahabr.ru/users/l2k/" class="comment-item__avatar">
                <img src="//habrastorage.org/getpro/habr/avatars/bf6/784/f3c/bf6784f3c323091e91f5deba0ae6641d_small.jpg" alt="" class="comment-item__avatar-img"/>
            </a>
            <a href="https://habrahabr.ru/users/l2k/" class="comment-item__username">l2k</a>
          </span>

          <time class="comment-item__time_published">
            30 марта 2009 в 18:36
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1499271" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1499271" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Давно пора об этом было поговорить :)
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1499271">
      
      
    </ul>

  </li>

  <li class="comment_item" id="comment_1499437" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1499437">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="kr1z">
            <a href="https://habrahabr.ru/users/kr1z/" class="comment-item__avatar">
                <img src="//habrastorage.org/getpro/habr/avatars/bea/866/286/bea8662865a25024786e54a1a80405c5_small.jpg" alt="" class="comment-item__avatar-img"/>
            </a>
            <a href="https://habrahabr.ru/users/kr1z/" class="comment-item__username">kr1z</a>
          </span>

          <time class="comment-item__time_published">
            30 марта 2009 в 19:22
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1499437" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1499437" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Супер и материал и оформление!
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1499437">
      
      
    </ul>

  </li>

  <li class="comment_item" id="comment_1500148" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1500148">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="leonard">
            <a href="https://habrahabr.ru/users/leonard/" class="comment-item__avatar">
                <img src="//habrastorage.org/getpro/habr/avatars/864/2f5/c9f/8642f5c9f081d8ec40ba9dae60c23966_small.jpg" alt="" class="comment-item__avatar-img"/>
            </a>
            <a href="https://habrahabr.ru/users/leonard/" class="comment-item__username">leonard</a>
          </span>

          <time class="comment-item__time_published">
            30 марта 2009 в 23:58
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1500148" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1500148" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Спасибо большое, очень давно интересовал этот вопрос, но руки не доходили разобраться. Было бы просто великолепно, если бы вы написали еще про создание простейшего wysiwyg редактора. 
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1500148">
      
  <li class="comment_item" id="comment_1500200" >
    
    <span class="parent_id" data-parent_id="1500148"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item is_topic_starter " rel="1500200">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="bur">
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__username">bur</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 00:20
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1500200" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1500200" data-parent_id="1500148" title="Показать ветку комментариев"></span>
              <a href="#comment_1500148" class="icon_comment-parent js-comment_parent" data-id="1500200" data-parent_id="1500148" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1500200" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Вэлкам!<br/>
Про простейший висивик есть даже одноименная статья:<br/>
<a href="http://fastcoder.org/articles/?aid=169">fastcoder.org/articles/?aid=169</a>
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1500200">
      
      
    </ul>

  </li>

      
    </ul>

  </li>

  <li class="comment_item" id="comment_1500163" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item is_topic_starter " rel="1500163">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="bur">
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__username">bur</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 00:03
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1500163" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1500163" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Вэлкам!<br/>
Про простейший висивик есть даже одноименная статья:<br/>
<a href="http://fastcoder.org/articles/?aid=169">fastcoder.org/articles/?aid=169</a><br/>

        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1500163">
      
  <li class="comment_item" id="comment_1500202" >
    
    <span class="parent_id" data-parent_id="1500163"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item is_topic_starter " rel="1500202">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="bur">
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__username">bur</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 00:21
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1500202" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1500202" data-parent_id="1500163" title="Показать ветку комментариев"></span>
              <a href="#comment_1500163" class="icon_comment-parent js-comment_parent" data-id="1500202" data-parent_id="1500163" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1500202" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Странно, первый раз ушло мимо треда…
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1500202">
      
      
    </ul>

  </li>

  <li class="comment_item" id="comment_1500226" >
    
    <span class="parent_id" data-parent_id="1500163"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1500226">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="mac2000">
            <a href="https://habrahabr.ru/users/mac2000/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/mac2000/" class="comment-item__username">mac2000</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 00:33
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1500226" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1500226" data-parent_id="1500163" title="Показать ветку комментариев"></span>
              <a href="#comment_1500163" class="icon_comment-parent js-comment_parent" data-id="1500226" data-parent_id="1500163" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1500226" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          вот немного более полная статья на тему<br/>
<a href="http://dev.opera.com/articles/view/rich-html-editing-in-the-browser-part-1/">dev.opera.com/articles/view/rich-html-editing-in-the-browser-part-1/</a>
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1500226">
      
      
    </ul>

  </li>

      
    </ul>

  </li>

  <li class="comment_item" id="comment_1500216" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1500216">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="mac2000">
            <a href="https://habrahabr.ru/users/mac2000/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/mac2000/" class="comment-item__username">mac2000</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 00:30
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1500216" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1500216" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          может автор подскажет как при вызове таких функций как InsertUnorderedList (или к примеру функции зачистки html кода) сохранить выделение/положение курсора? перепробывал кучу всяких вариантов — ничего толкового…
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1500216">
      
  <li class="comment_item" id="comment_1500254" >
    
    <span class="parent_id" data-parent_id="1500216"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item is_topic_starter " rel="1500254">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="bur">
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__username">bur</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 00:47
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1500254" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1500254" data-parent_id="1500216" title="Показать ветку комментариев"></span>
              <a href="#comment_1500216" class="icon_comment-parent js-comment_parent" data-id="1500254" data-parent_id="1500216" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1500254" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Вероятно, вы имеете в виду команду «InsertUnorderedList» метода execCommand?<br/>
<br/>
На вскидку, можно попробовать сохранять выделение(фокус) в виде Range(TextRange)-объекта, производить манипуляцию, а затем восстанавливать фокус из сохраненного объекта. Примерно так:<br/>
<br/>
// Получим выделение (фокус)<br/>
var sel = window.getSelection? window.getSelection(): document.selection;<br/>
// Создадим из него Range(TextRange)-объект<br/>
var rng = window.getSelection? sel.getRangeAt(0): sel.createRange();<br/>
// На всякий случай сделаем клон<br/>
var rngClone = window.getSelection? rng.cloneRange(): rng.duplicate();<br/>
/*<br/>
Здесь выполним нужную команду метода execCommand<br/>
*/<br/>
// Восстановим фокус из клона<br/>
if ( window.getSelection ) {<br/>
sel = window.getSelection();<br/>
sel.removeAllRanges();<br/>
sel.addRange( rngClone );<br/>
} else rngClone.select();<br/>
<br/>
Набивал прямо здесь без проверки, так что возможны ошибки, да и код можно оптимизировать. Но направление мыслей должно быть понятным…
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1500254">
      
  <li class="comment_item" id="comment_1500270" >
    
    <span class="parent_id" data-parent_id="1500254"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1500270">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="mac2000">
            <a href="https://habrahabr.ru/users/mac2000/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/mac2000/" class="comment-item__username">mac2000</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 00:55
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1500270" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1500270" data-parent_id="1500254" title="Показать ветку комментариев"></span>
              <a href="#comment_1500254" class="icon_comment-parent js-comment_parent" data-id="1500270" data-parent_id="1500254" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1500270" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          все бы хорошо, но в range сохраняется контейнер и смещение — которых после операции может попросту не быть, или смещение может быть уже совсем другим…<br/>
<br/>
из того что я рыл в коде тини — они оставляют некие букмарки\якоря по которым потом востанавливают выделение — но как это сделано там я так и не смог осилить…
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1500270">
      
  <li class="comment_item" id="comment_1500282" >
    
    <span class="parent_id" data-parent_id="1500270"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item is_topic_starter " rel="1500282">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="bur">
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__username">bur</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 01:09
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1500282" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1500282" data-parent_id="1500270" title="Показать ветку комментариев"></span>
              <a href="#comment_1500270" class="icon_comment-parent js-comment_parent" data-id="1500282" data-parent_id="1500270" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1500282" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Если используемая вами команда занимается вставкой данных, то описанный выше скрипт должен справляться.<br/>
<br/>
В контексте объекта TextRange можно вызвать метод getBookmark(), который вернет строку (там свой внутренний формат какой-то). Позже, скормив эту строку методу moveToBookmark(), вы можете восставновить фокус. Это, кстати, описано в статье. Работает в ИЕ соот-но.<br/>
<br/>
Аналогичного интерфейса в DOM Range не встречал, используйте стандартные свойства и методы.<br/>

        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1500282">
      
      
    </ul>

  </li>

      
    </ul>

  </li>

      
    </ul>

  </li>

      
    </ul>

  </li>

  <li class="comment_item" id="comment_1501160" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1501160">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="Guria">
            <a href="https://habrahabr.ru/users/Guria/" class="comment-item__avatar">
                <img src="//habrastorage.org/getpro/habr/avatars/20d/a8b/6f9/20da8b6f9480186d60e4ffd18673889a_small.jpg" alt="" class="comment-item__avatar-img"/>
            </a>
            <a href="https://habrahabr.ru/users/Guria/" class="comment-item__username">Guria</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 13:14
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1501160" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1501160" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Коллективный разум существует? Вчера искал инфу по установке пользовательских выделений, но все на что натыкался в основном было про текст в инпутах. И вчера же появляется ваша статья здесь, в которой всё доходчиво изложено. Спасибо за труд.
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1501160">
      
  <li class="comment_item" id="comment_1501186" >
    
    <span class="parent_id" data-parent_id="1501160"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item is_topic_starter " rel="1501186">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="bur">
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__avatar">
                <span class="comment-item__avatar-img_default user-pic_blue"></span>
            </a>
            <a href="https://habrahabr.ru/users/bur/" class="comment-item__username">bur</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 13:23
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1501186" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1501186" data-parent_id="1501160" title="Показать ветку комментариев"></span>
              <a href="#comment_1501160" class="icon_comment-parent js-comment_parent" data-id="1501186" data-parent_id="1501160" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1501186" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Эту статью я начал писать в феврале, когда окончательно надоело собирать API по пяти разным ссылкам. Недавно дописал и выложил на fastcoder.org. Ну а потом подумалось, что материал будет полезен хабровчанам. Хорошо, что не ошибся :-)
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1501186">
      
  <li class="comment_item" id="comment_1501878" >
    
    <span class="parent_id" data-parent_id="1501186"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="1501878">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="django">
            <a href="https://habrahabr.ru/users/django/" class="comment-item__avatar">
                <img src="//habrastorage.org/getpro/habr/avatars/ad7/7b8/83a/ad77b883a27d760fdf606e151714e267_small.png" alt="" class="comment-item__avatar-img"/>
            </a>
            <a href="https://habrahabr.ru/users/django/" class="comment-item__username">django</a>
          </span>

          <time class="comment-item__time_published">
            31 марта 2009 в 16:46
          </time>

          <span class="comment-item__controls">
            <a href="#comment_1501878" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


              <span class="icon_comment-tree js-comment_tree" data-id="1501878" data-parent_id="1501186" title="Показать ветку комментариев"></span>
              <a href="#comment_1501186" class="icon_comment-parent js-comment_parent" data-id="1501878" data-parent_id="1501186" title="Показать предыдущий комментарий"></a>
            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_1501878" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Огромное спасибо Вам. Сам недавно ковырялся по частям разных документаций по Range (нужно было с FCK Editor дёргать положение курсора), и это ужасно надоедало.
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_1501878">
      
      
    </ul>

  </li>

      
    </ul>

  </li>

      
    </ul>

  </li>

  <li class="comment_item" id="comment_3642484" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="3642484">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="anmiles">
            <a href="https://habrahabr.ru/users/anmiles/" class="comment-item__avatar">
                <img src="//habrastorage.org/getpro/habr/avatars/47f/749/8db/47f7498db07c8d7c8e6d6a6f88be15e6_small.png" alt="" class="comment-item__avatar-img"/>
            </a>
            <a href="https://habrahabr.ru/users/anmiles/" class="comment-item__username">anmiles</a>
          </span>

          <time class="comment-item__time_published">
             9 февраля 2011 в 10:35
          </time>

          <span class="comment-item__controls">
            <a href="#comment_3642484" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_3642484" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Думаю, было бы полезно добавить инфу о том, как выделить/получить выделение текстбокса.<br/>
<br/>
Например, выделить символы со второго до предпоследнего:<br/>
<br/>
input.select(); <br/>
input.selectionStart = 1;<br/>
input.selectionEnd = input.value.length — 1;<br/>

        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_3642484">
      
      
    </ul>

  </li>

  <li class="comment_item" id="comment_5108041" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="5108041">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="kuchumovn">
            <a href="https://habrahabr.ru/users/kuchumovn/" class="comment-item__avatar">
                <img src="//habrastorage.org/getpro/habr/avatars/0c5/272/d17/0c5272d17f5ad1b9b1137e2d01ac50ad_small.jpg" alt="" class="comment-item__avatar-img"/>
            </a>
            <a href="https://habrahabr.ru/users/kuchumovn/" class="comment-item__username">kuchumovn</a>
          </span>

          <time class="comment-item__time_published">
             4 сентября 2012 в 01:52
          </time>

          <span class="comment-item__controls">
            <a href="#comment_5108041" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_5108041" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Хорошая статья, до сих пор к ней возвращаюсь (пишу визуальный редактор)
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_5108041">
      
      
    </ul>

  </li>

  <li class="comment_item" id="comment_5763375" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="5763375">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="cheremushkin">
            <a href="https://habrahabr.ru/users/cheremushkin/" class="comment-item__avatar">
                <img src="//habrastorage.org/getpro/habr/avatars/a9e/1e1/484/a9e1e1484723a03caf68ef8a57508043_small.jpg" alt="" class="comment-item__avatar-img"/>
            </a>
            <a href="https://habrahabr.ru/users/cheremushkin/" class="comment-item__username">cheremushkin</a>
          </span>

          <time class="comment-item__time_published">
            23 января 2013 в 20:05
          </time>

          <span class="comment-item__controls">
            <a href="#comment_5763375" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_5763375" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Автор, подскажите пожалуйста, как быть в моем случае?<br/>
Мне нужно получить текст только из одного узла. Т.е. если имеется div, внутри которого есть текст, то при выделении и нажатии на кнопку я хочу, чтобы выделение идентифицировалось только в случае если оно находится в этом div.<br/>
Вот так я получаю выделение ото всюду. Но ведь getSelection() — метод window, а следовательно его я не могу заменить его на свой узел.<br/>
<br/>
var selection = window.getSelection().getRangeAt(0);<br/>
<br/>
Буду благодарен за помощь.
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_5763375">
      
      
    </ul>

  </li>

  <li class="comment_item" id="comment_6835450" >
    
    <span class="parent_id" data-parent_id="0"></span>

    <div class="comment_body ">
        <div class="info comments-list__item comment-item  " rel="6835450">

          <div class="folding-dot-holder"><div class="folding-dot"></div></div>

          <span class="comment-item__user-info"  data-user-login="BleSSeD">
            <a href="https://habrahabr.ru/users/BleSSeD/" class="comment-item__avatar">
                <img src="//habrastorage.org/getpro/habr/avatars/27c/40a/5ea/27c40a5ea0d98a401147179c7b4ef127_small.jpg" alt="" class="comment-item__avatar-img"/>
            </a>
            <a href="https://habrahabr.ru/users/BleSSeD/" class="comment-item__username">BleSSeD</a>
          </span>

          <time class="comment-item__time_published">
            10 октября 2013 в 16:51
          </time>

          <span class="comment-item__controls">
            <a href="#comment_6835450" class="icon_comment-anchor" title="Ссылка на комментарий"></a>


            <span class="js-comment_chidren" title="Вернуться к ответу"></span>
          </span>

            <div id="voting_6835450" class="voting-wjt voting-wjt_comments js-voting   ">

              <div class="voting-wjt__counter js-mark  ">
                <span class="voting-wjt__counter-score js-score" title="Всего 0: &uarr;0 и &darr;0">0</span>
              </div>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_plus js-plus" title="Голосовать могут только зарегистрированные пользователи"><span>&uarr;</span></button>

                <button type="button" disabled class="voting-wjt__button voting-wjt__button_minus js-minus" title="Голосовать могут только зарегистрированные пользователи"><span>&darr;</span></button>
            </div>
        </div>

        <div class="message html_format ">
          Есть еще либа для таких нужд: <a href="https://code.google.com/p/rangy/">code.google.com/p/rangy/</a>
        </div>

        <div class="reply_form_placeholder"></div>

        <div class="reply">

        </div>
    </div>

    <ul class="reply_comments" id="reply_comments_6835450">
      
      
    </ul>

  </li>

      
    </ul>

  </div>


                <p class="for_users_only_msg">Только зарегистрированные пользователи могут оставлять комментарии. <a href="https://habrahabr.ru/auth/login/">Войдите</a>, пожалуйста.</p>


      
<form action="/json/favorites/" method="post" id="edit_tags_form" class="hidden">
  <input type="hidden" name="action" value="add" />
  <input type="hidden" name="ti" value="0" />
  <input type="hidden" name="tt" value="0" />
  <label>Пометьте топик понятными вам метками, если хотите</label>
  <input type="text" name="tags_string" class="tags_string" />
  <div class="description">Метки лучше разделять запятой. Например: <i>общение, социальные сети, myspace.com, подростки, мердок</i></div>
  <input type="submit" value="Сохранить" class="submit" /> или <a href="#" class="close" onclick="return close_edit_tags()">закрыть</a>
</form>

    </div>
    <div class="sidebar_right js-sidebar_right">
          

  <div class="live-broadcast live-broadcast_habrahabr">
    <h2 class="live-broadcast__title">Что обсуждают</h2>
    <div class="live-broadcast__tabs tabs" id="broadcast_tabs_comments">
      <ul class="tabs__menu tabs__menu_comments menu menu_inline">
        <li class="menu__item"><a href="#broadcast_comments_now" class="menu__item-tab">Сейчас</a></li>
        <li class="menu__item"><a href="#broadcast_comments_yesterday" class="menu__item-tab">Вчера</a></li>
        <li class="menu__item"><a href="#broadcast_comments_week" class="menu__item-tab">Неделя</a></li>
        <li class="menu__item"><a href="#broadcast_comments_month" class="menu__item-tab">Месяц</a></li>
      </ul>

        <div class="tabs__content" id="broadcast_comments_now">
            <ul class="content-list content-list_comments" >
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/company/everydaytools/blog/320796/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Как сделать девушке предложение при помощи социальной инженерии</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/company/everydaytools/blog/320796/#comments" class="content-list__item-counter icon_comments">11</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320542/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Hibernate для начинающих</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320542/#comments" class="content-list__item-counter icon_comments">23</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320818/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Расстрельная статья: маркетинг и пиар в ИТ</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320818/#comments" class="content-list__item-counter icon_comments">58</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320602/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Борьба с читерами в онлайн-играх: 22 «нужно» и «нельзя»</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320602/#comments" class="content-list__item-counter icon_comments">96</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/company/tmru/blog/320532/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Битва Wordpress титанов: Monstroid 2 vs Divi, X Theme, Avada, Enfold</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/company/tmru/blog/320532/#comments" class="content-list__item-counter icon_comments">15</a>
                </li>
            </ul>
        </div>
        <div class="tabs__content" id="broadcast_comments_yesterday">
            <ul class="content-list content-list_comments" >
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320782/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Agile умер, да здравствует… Agile</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320782/#comments" class="content-list__item-counter icon_comments">63</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320818/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Расстрельная статья: маркетинг и пиар в ИТ</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320818/#comments" class="content-list__item-counter icon_comments">58</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320664/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Google ReCAPTCHA Invisible или долой дорожные знаки и витрины магазинов</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320664/#comments" class="content-list__item-counter icon_comments">43</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320830/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Однострочный калькулятор, искусство или порок?</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320830/#comments" class="content-list__item-counter icon_comments">39</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320742/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Нейронные сети за 1 день</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320742/#comments" class="content-list__item-counter icon_comments">36</a>
                </li>
            </ul>
        </div>
        <div class="tabs__content" id="broadcast_comments_week">
            <ul class="content-list content-list_comments" >
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/company/vivaldi/blog/320308/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Пора играть честно, Microsoft</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/company/vivaldi/blog/320308/#comments" class="content-list__item-counter icon_comments">434</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320704/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Subversion vs. Git: Развенчивание мифов о развенчивании мифов</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320704/#comments" class="content-list__item-counter icon_comments">200</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320374/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Дайте мне точку опоры или безопасный Интернет — это реальность</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320374/#comments" class="content-list__item-counter icon_comments">172</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320548/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Обратная сторона Agile — разбирая чужие ошибки</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320548/#comments" class="content-list__item-counter icon_comments">124</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/320476/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">ТЗ высокой четкости</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320476/#comments" class="content-list__item-counter icon_comments">123</a>
                </li>
            </ul>
        </div>
        <div class="tabs__content" id="broadcast_comments_month">
            <ul class="content-list content-list_comments" >
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/319232/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Обратная сторона Agile</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/319232/#comments" class="content-list__item-counter icon_comments">579</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/319774/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">IDEA пора закапывать?</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/319774/#comments" class="content-list__item-counter icon_comments">519</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/company/vivaldi/blog/320308/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Пора играть честно, Microsoft</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/company/vivaldi/blog/320308/#comments" class="content-list__item-counter icon_comments">434</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/318916/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Писать веб-сайты на ассемблере полезно и приятно</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/318916/#comments" class="content-list__item-counter icon_comments">428</a>
                </li>
                <li class="content-list__item">
                  <a href="https://habrahabr.ru/post/319084/" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'live_broadcast_activity', 'comment'); }" class="content-list__item-link">Обещания Google начали сбываться — теперь сайты https помечаются как надёжные</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/319084/#comments" class="content-list__item-counter icon_comments">321</a>
                </li>
            </ul>
        </div>
    </div>
  </div>

    </div>
  </div>

  <div class="column-wrapper column-wrapper_bottom column-wrapper_bordered">
    <div class="content_left">
      

  <div class="live-broadcast live-broadcast_feed">
    <h2 class="live-broadcast__title live-broadcast__title_feed">Интересные публикации</h2>

    <div class="dropdown dropdown_broadcast">
      <button type="button" class="btn btn_outline_grey btn_large icon_cog dropdown-toggle" data-toggle="dropdown">
      </button>
      <div class="dropdown-container">
        <ul class="n-dropdown-menu n-dropdown-menu_feed" id="filter">
          <li class="n-dropdown-menu__item">
            <label class="checkbox checkbox_custom">
              <input type="checkbox" class="checkbox__input" name="habrahabr" checked/>
              <span class="checkbox__label">Хабрахабр</span>
            </label>
          </li>
          <li class="n-dropdown-menu__item">
            <label class="checkbox checkbox_custom">
              <input type="checkbox" class="checkbox__input" name="geektimes" checked/>
              <span class="checkbox__label">Гиктаймс</span>
            </label>
          </li>
        </ul>
      </div>
    </div>

    <div class="live-broadcast__content">
      <ul class="content-list content-list_feed" id="list" data-posts-count="5">
          <li class="content-list__item content-list__item_habrahabr hidden" data-type="habrahabr">
            <a href="https://habrahabr.ru/post/319884/" class="content-list__item-link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'post'); }" data-utm="?utm_source=tm_megamozg&utm_medium=tm_block&utm_campaign=tm_promo">Оптимизация работы портальной дизайн-команды с помощью Sketch и облака</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/319884/#comments" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'comment'); }" class="content-list__item-counter icon_comments">0</a>
          </li>
          <li class="content-list__item content-list__item_habrahabr hidden" data-type="habrahabr">
            <a href="https://habrahabr.ru/post/320802/" class="content-list__item-link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'post'); }" data-utm="?utm_source=tm_megamozg&utm_medium=tm_block&utm_campaign=tm_promo">Как работают ИТ-специалисты. Антон Чарченко, Tehnical Lead в EnglishDom</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320802/#comments" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'comment'); }" class="content-list__item-counter icon_comments">0</a>
          </li>
          <li class="content-list__item content-list__item_geektimes hidden" data-type="geektimes">
            <a href="https://geektimes.ru/post/285338/" class="content-list__item-link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'post'); }" data-utm="?utm_source=tm_megamozg&utm_medium=tm_block&utm_campaign=tm_promo">Хронометр для космических первопроходцев</a>&nbsp;&nbsp;<a href="https://geektimes.ru/post/285338/#comments" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'comment'); }" class="content-list__item-counter icon_comments">1</a>
          </li>
          <li class="content-list__item content-list__item_habrahabr hidden" data-type="habrahabr">
            <a href="https://habrahabr.ru/post/320552/" class="content-list__item-link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'post'); }" data-utm="?utm_source=tm_megamozg&utm_medium=tm_block&utm_campaign=tm_promo">Повышаем безопасность контейнеров Docker</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320552/#comments" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'comment'); }" class="content-list__item-counter icon_comments">1</a>
          </li>
          <li class="content-list__item content-list__item_habrahabr hidden" data-type="habrahabr">
            <a href="https://habrahabr.ru/post/320842/" class="content-list__item-link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'post'); }" data-utm="?utm_source=tm_megamozg&utm_medium=tm_block&utm_campaign=tm_promo">Материалы журналов Университета ИТМО: исследования в сфере обработки изображений и компьютерного моделирования</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/320842/#comments" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'comment'); }" class="content-list__item-counter icon_comments">0</a>
          </li>
          <li class="content-list__item content-list__item_habrahabr hidden" data-type="habrahabr">
            <a href="https://habrahabr.ru/post/319616/" class="content-list__item-link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'post'); }" data-utm="?utm_source=tm_megamozg&utm_medium=tm_block&utm_campaign=tm_promo">Дайджест: Все о работе с IaaS и примеры практических кейсов клиентов ИТ-ГРАД</a>&nbsp;&nbsp;<a href="https://habrahabr.ru/post/319616/#comments" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'comment'); }" class="content-list__item-counter icon_comments">0</a>
          </li>
          <li class="content-list__item content-list__item_geektimes hidden" data-type="geektimes">
            <a href="https://geektimes.ru/post/285328/" class="content-list__item-link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'post'); }" data-utm="?utm_source=tm_megamozg&utm_medium=tm_block&utm_campaign=tm_promo">Как мы для музея науки сделали самую большую катушку Тесла в Украине</a>&nbsp;&nbsp;<a href="https://geektimes.ru/post/285328/#comments" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'comment'); }" class="content-list__item-counter icon_comments">24</a>
          </li>
          <li class="content-list__item content-list__item_geektimes hidden" data-type="geektimes">
            <a href="https://geektimes.ru/post/285332/" class="content-list__item-link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'post'); }" data-utm="?utm_source=tm_megamozg&utm_medium=tm_block&utm_campaign=tm_promo">Microsoft разрабатывает адаптивную оболочку для Windows 10</a>&nbsp;&nbsp;<a href="https://geektimes.ru/post/285332/#comments" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'comment'); }" class="content-list__item-counter icon_comments">45</a>
          </li>
          <li class="content-list__item content-list__item_geektimes hidden" data-type="geektimes">
            <a href="https://geektimes.ru/post/285326/" class="content-list__item-link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'post'); }" data-utm="?utm_source=tm_megamozg&utm_medium=tm_block&utm_campaign=tm_promo">Новая краска от химиков из НАСА поможет ракете SLS выдержать бафтинг</a>&nbsp;&nbsp;<a href="https://geektimes.ru/post/285326/#comments" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'comment'); }" class="content-list__item-counter icon_comments">13</a>
          </li>
          <li class="content-list__item content-list__item_geektimes hidden" data-type="geektimes">
            <a href="https://geektimes.ru/post/285318/" class="content-list__item-link" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'post'); }" data-utm="?utm_source=tm_megamozg&utm_medium=tm_block&utm_campaign=tm_promo">Основатель Virtus.pro стал владельцем бизнеса по производству оборудования для перехвата и хранения трафика</a>&nbsp;&nbsp;<a href="https://geektimes.ru/post/285318/#comments" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'interesting_posts', 'comment'); }" class="content-list__item-counter icon_comments">9</a>
          </li>
      </ul>
    </div>
  </div>

    </div>

    <div class="sidebar_right">
        <div class="xyz_wrapper js-ad_sticky_bottom">
  <div class="xyz_wrapper_inner">
    <span class="xyz_wrapper_text">Реклама помогает поддерживать и&nbsp;развивать наши сервисы<br/><br/><a href="/adblock/" class="xyz_wrapper_button" target="_blank">Подробнее</a></span>
    <!-- Yandex.RTB R-A-149298-20 -->
    <div id="yandex_rtb_R-A-149298-20" style="background: #fff;"></div>
    <script type="text/javascript">
        (function(w, d, n, s, t) {
            w[n] = w[n] || [];
            w[n].push(function() {
                Ya.Context.AdvManager.render({
                    blockId: "R-A-149298-20",
                    renderTo: "yandex_rtb_R-A-149298-20",
                    async: true
                });
            });
            t = d.getElementsByTagName("script")[0];
            s = d.createElement("script");
            s.type = "text/javascript";
            s.src = "//an.yandex.ru/system/context.js";
            s.async = true;
            t.parentNode.insertBefore(s, t);
        })(this, this.document, "yandexContextAsyncCallbacks");
    </script>
  </div>
  <a href="https://special.habrahabr.ru/advertising/" class="firskill__label">Реклама</a>
</div>

    </div>
  </div>
  <script>
  window._yaparams = {'hubs':[], 'flow':'develop (Разработка)'};
  // hubs to GA
  _yaparams['hubs'].push('javascript (JavaScript)');
</script>

      </div>
      <div class="layout__footer">
        <div class="footer_panel">
  <div id="footer">
    <dl>
      <dd><a href="https://habrahabr.ru/auth/login/">Войти</a></dd>
      <dd><a href="https://habrahabr.ru/auth/register/">Регистрация</a></dd>
    </dl>
    <dl>
      <dt>Разделы</dt>
      <dd><a href="https://habrahabr.ru/posts/top/">Публикации</a></dd>
      <dd><a href="https://habrahabr.ru/hubs/">Хабы</a></dd>
      <dd><a href="https://habrahabr.ru/companies/">Компании</a></dd>
      <dd><a href="https://habrahabr.ru/users/">Пользователи</a></dd>
      <dd><a href="https://toster.ru/?_aa=press_anykey">Q&amp;A</a></dd>
      <dd><a href="https://habrahabr.ru/sandbox/">Песочница</a></dd>

    </dl>
    <dl>
      <dt>Инфо</dt>
      <dd><a href="/info/about/">О сайте</a></dd>
      <dd><a href="/info/help/rules/">Правила</a></dd>
      <dd><a href="/info/help/">Помощь</a></dd>
      <dd><a href="/info/agreement/">Соглашение</a></dd>
    </dl>
    <dl>
      <dt>Услуги</dt>
      <dd><a href="https://special.habrahabr.ru/advertising/">Реклама</a></dd>
      <dd><a href="https://special.habrahabr.ru/corporate/">Тарифы</a></dd>
      <dd><a href="https://special.habrahabr.ru/content/">Контент</a></dd>
      <dd><a href="https://special.habrahabr.ru/workshops/">Семинары</a></dd>
    </dl>

    <dl>
      <dt>Разное</dt>
      <dd><a href="https://appmetrica.yandex.com/serve/240693928167260216?utm_source=HH_desktop&utm_medium=button&utm_campaign=appiOS" target="_blank" onclick="if (typeof ga === 'function') { ga('send', 'event', 'footer', 'links', 'ios_app'); }">iOS приложение</a></dd>
      <dd><a href="https://appmetrica.yandex.com/serve/745097116363323173?id=ru.habrahabr&utm_source=HH_desktop&utm_medium=button&utm_campaign=appAndroid" target="_blank" onclick="if (typeof ga === 'function') { ga('send', 'event', 'footer', 'links', 'android_app'); }">Android приложение</a></dd>
      <dd><a href="https://special.habrahabr.ru/hello_startup/habrahabr/" target="_blank">Помощь стартапам</a></dd>
    </dl>

    <div class="copyright">
      <div class="about">
        <a href="https://tmtm.ru/">© TM</a>
        <br><br>
        <a href="https://habrahabr.ru/feedback/">Служба поддержки</a><br><br>
          <a href="https://m.habrahabr.ru/post/55922/?mobile=yes">Мобильная версия</a><br><br>
        <div class="social_accounts">
          <a href="https://twitter.com/habrahabr" target="_blank" onclick="if (typeof ga === 'function') { ga('send', 'event', 'footer', 'Social_icons', 'twitter'); }">
            <svg class="icon-svg icon-svg_twitter" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M12 24c-6.616 0-12-5.384-12-12s5.384-12 12-12 12 5.384 12 12-5.384 12-12 12zm0-22.909c-6.015 0-10.909 4.894-10.909 10.909s4.894 10.909 10.909 10.909 10.909-4.894 10.909-10.909-4.894-10.909-10.909-10.909zM18.04 8.253c-.445.197-.922.331-1.424.391.512-.307.904-.792 1.09-1.371-.479.284-1.009.49-1.574.601-.452-.481-1.096-.782-1.809-.782-1.369 0-2.479 1.109-2.479 2.479 0 .194.022.383.064.565-2.06-.104-3.887-1.091-5.109-2.59-.214.365-.336.792-.336 1.246 0 .86.437 1.619 1.103 2.063-.406-.013-.789-.124-1.123-.31v.031c0 1.201.854 2.203 1.989 2.431-.207.057-.427.087-.653.087-.159 0-.314-.015-.466-.045.315.985 1.231 1.702 2.316 1.721-.849.664-1.917 1.061-3.079 1.061-.2 0-.397-.012-.591-.035 1.095.704 2.398 1.114 3.799 1.114 4.559 0 7.052-3.777 7.052-7.053l-.008-.321c.484-.349.904-.785 1.237-1.283z"/></svg>
          </a>
          <a href="https://www.facebook.com/habrahabr.ru" target="_blank" onclick="if (typeof ga === 'function') { ga('send', 'event', 'footer', 'Social_icons', 'facebook'); }">
            <svg class="icon-svg icon-svg_fb" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M12 24c-6.616 0-12-5.384-12-12s5.384-12 12-12 12 5.384 12 12-5.384 12-12 12zm0-22.909c-6.015 0-10.909 4.894-10.909 10.909s4.894 10.909 10.909 10.909 10.909-4.894 10.909-10.909-4.894-10.909-10.909-10.909zM14.727 8.798h-1.558c-.184 0-.389.242-.389.566v1.125h1.947v1.604h-1.948v4.816h-1.839v-4.816h-1.667v-1.604h1.668v-.944c0-1.354.939-2.455 2.229-2.455h1.558v1.707z"/></svg>
          </a>
          <a href="https://vk.com/habr" target="_blank" onclick="if (typeof ga === 'function') { ga('send', 'event', 'footer', 'Social_icons', 'vkontakte'); }">
            <svg class="icon-svg icon-svg_vk" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M12 24c-6.616 0-12-5.384-12-12s5.384-12 12-12 12 5.384 12 12-5.384 12-12 12zm0-22.909c-6.015 0-10.909 4.894-10.909 10.909s4.894 10.909 10.909 10.909 10.909-4.894 10.909-10.909-4.894-10.909-10.909-10.909zM16.33 11.926s1.725-2.433 1.896-3.232c.057-.286-.069-.445-.365-.445h-1.497c-.343 0-.468.148-.572.365 0 0-.809 1.724-1.793 2.81-.316.351-.477.457-.651.457-.141 0-.205-.118-.205-.434v-2.776c0-.388-.046-.503-.365-.503h-2.399c-.183 0-.297.106-.297.251 0 .365.56.448.56 1.439v2.044c0 .411-.023.572-.217.572-.514 0-1.737-1.771-2.422-3.781-.137-.41-.286-.525-.674-.525h-1.496c-.217 0-.377.148-.377.365 0 .399.468 2.251 2.307 4.729 1.234 1.668 2.856 2.57 4.318 2.57.891 0 1.108-.148 1.108-.526v-1.28c0-.32.125-.457.309-.457.205 0 .568.067 1.416.902 1.005.96 1.073 1.359 1.622 1.359h1.679c.171 0 .332-.08.332-.365 0-.377-.491-1.051-1.245-1.85-.309-.411-.811-.856-.971-1.063-.229-.239-.16-.376 0-.627z"/></svg>
          </a>
          <a href="https://telegram.me/habr_ru" target="_blank" onclick="if (typeof ga === 'function') { ga('send', 'event', 'footer', 'Social_icons', 'telegram'); }">
            <svg class="icon-svg icon-svg_telegram" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M12.048.002c-6.616 0-12 5.384-12 12s5.384 12 12 12 12-5.384 12-12-5.384-12-12-12zm0 22.909c-6.015 0-10.909-4.894-10.909-10.909s4.894-10.909 10.909-10.909 10.909 4.894 10.909 10.909c0 6.015-4.894 10.909-10.909 10.909zM10.093 16.753c0 .164.092.209.219.094l1.891-1.697-2.11-1.092v2.696zM17.816 7.116c-.228.081-11.491 4.049-11.712 4.127-.189.067-.23.229-.007.319l2.518 1.009 1.493.598s7.189-5.28 7.287-5.351c.098-.072.211.063.14.14l-5.222 5.648-.3.334.397.214 3.304 1.779c.192.104.443.017.499-.223.065-.283 1.887-8.134 1.928-8.308.052-.226-.097-.364-.325-.285z"/></svg>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
      </div>
      <a href="#" class="layout__elevator hidden" id="scroll_to_top" title="Наверх"  onclick="if (typeof ga === 'function') { ga('send', 'event', 'navigation_button', 'down', 'https://habrahabr.ru/post/55922/'); }">
        <svg class="icon-svg icon-svg_scroll-up" width="32" height="32" viewBox="0 0 32 32" aria-hidden="true" version="1.1" role="img"><path d="M16 0C7.164 0 0 7.164 0 16s7.164 16 16 16 16-7.164 16-16S24.836 0 16 0zm8.412 19.523c-.517.512-1.355.512-1.872 0L16 13.516l-6.54 6.01c-.518.51-1.356.51-1.873 0-.516-.513-.517-1.343 0-1.855l7.476-7.326c.517-.512 1.356-.512 1.873 0l7.476 7.327c.516.513.516 1.342 0 1.854z"/></svg>
      </a>
    </div>

    <script type="text/javascript">
  // global vars
  var g_base_url = 'habrahabr.ru';
  var g_show_xpanel = false;
  var g_base_fullurl = 'https://habrahabr.ru/';
  var g_is_guest = false;

</script>
    
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//stats.tmtm.ru/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '5']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//stats.tmtm.ru/piwik.php?idsite=5" style="border:0;" alt="" /></p></noscript>


    <script src="https://habracdn.net/habr/javascripts/1485793001/app.vendors.js"></script>
    <script src="https://habracdn.net/habr/javascripts/1485793001/app.main.js"></script>
    <script src="https://habracdn.net/habr/javascripts/1485793001/libs/flexibility.js"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        showProcessingMessages: false,
        showMathMenu: true,
        tex2jax: {
          inlineMath: [['$inline$','$inline$']],
          displayMath: [['$$display$$','$$display$$']],
          processEscapes: true
        },
        MathMenu: {
          showRenderer: true,
          showContext:  true
        }
      });

      MathJax.Extension.Img2jax = {
        PreProcess: function (element) {
          var hasMath = false;
          var images = element.querySelectorAll('[data-tex]');
          for (var i = images.length - 1; i >= 0; i--) {
            var img = images[i];
            var tex = img.alt.replace(/(\r\n|\n|\r)/gm, " ");
            if (tex && tex[0] === '$'){
              var script = document.createElement("script"); script.type = "math/tex";
              hasMath = true;
              if (img.getAttribute('data-tex') == "display"){script.type += ";mode=display"}
              MathJax.HTML.setScript(script, tex.substring(1,tex.length-1));
              img.parentNode.replaceChild(script,img);
            }
          }
        }
      };

      MathJax.Hub.Register.PreProcessor(["PreProcess", MathJax.Extension.Img2jax]);
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG-full&locale=ru"></script>
        <script src="https://habracdn.net/habr/javascripts/1485793001/libs/piwikscrolldepth.min.js"></script>
    <script type="text/javascript">
      gascrolldepth.init({
        percentage: true,
        PiwikGoal: true,
        PiwikGoal20: 3,
        PiwikGoal50: 15,
        PiwikGoal70: 17,
        PiwikGoal90: 19,
        PiwikGoal100: 20
      });
    </script>


      <script type="text/javascript">
        $(document).ready( function(){
          window.tmidLogin = function(){ return false; };
          if( $.cookie('tmid_no_check') == undefined ) {
            var expire = new Date();
            expire.setMinutes(expire.getMinutes() + 10 );
            $.cookie('tmid_no_check', 1, { expires: expire } );
            $.getScript("https://id.tmtm.ru/checklogin/", function(){
              if( window.tmidLogin() ) {
                var href = $('#login').attr('href')+'?checklogin=true';
                if( href !== undefined ) { window.location.href = href; }
              }
            });
          }
        });
      </script>

      <script type="text/javascript" src="https://habrahabr.ru/viewcount/post/55922/"></script>

    
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            if (typeof (_yaparams) != 'undefined') {
                w.yaCounter24049213 = new Ya.Metrika({id:24049213,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    params:_yaparams});
            } else {
                w.yaCounter24049213 = new Ya.Metrika({id:24049213,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
            }

        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

    
    
  </body>
</html>
